var app=function(){"use strict";function e(){}const t=e=>e;function n(e,t){for(const n in t)e[n]=t[n];return e}function o(e){return e()}function r(){return Object.create(null)}function s(e){e.forEach(o)}function l(e){return"function"==typeof e}function i(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function c(t,n,o){t.$$.on_destroy.push(function(t,...n){if(null==t)return e;const o=t.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}(n,o))}const u="undefined"!=typeof window;let a=u?()=>window.performance.now():()=>Date.now(),f=u?e=>requestAnimationFrame(e):e;const d=new Set;function p(e){d.forEach(t=>{t.c(e)||(d.delete(t),t.f())}),0!==d.size&&f(p)}function m(e,t){e.appendChild(t)}function h(e,t,n){e.insertBefore(t,n||null)}function g(e){e.parentNode.removeChild(e)}function $(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function v(e){return document.createElement(e)}function _(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function b(e){return document.createTextNode(e)}function w(){return b(" ")}function y(){return b("")}function x(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function k(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function S(e){return""===e?null:+e}function C(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function E(e,t){e.value=null==t?"":t}function A(e,t,n,o){e.style.setProperty(t,n,o?"important":"")}function T(e,t){for(let n=0;n<e.options.length;n+=1){const o=e.options[n];if(o.__value===t)return void(o.selected=!0)}}function N(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}function j(e,t,n){e.classList[n?"add":"remove"](t)}let G;function I(e){G=e}function O(){if(!G)throw new Error("Function called outside component initialization");return G}function R(){const e=O();return(t,n)=>{const o=e.$$.callbacks[t];if(o){const r=function(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}(t,n);o.slice().forEach(t=>{t.call(e,r)})}}}const W=[],U=[],P=[],L=[],M=Promise.resolve();let z=!1;function q(e){P.push(e)}let D=!1;const B=new Set;function V(){if(!D){D=!0;do{for(let e=0;e<W.length;e+=1){const t=W[e];I(t),K(t.$$)}for(I(null),W.length=0;U.length;)U.pop()();for(let e=0;e<P.length;e+=1){const t=P[e];B.has(t)||(B.add(t),t())}P.length=0}while(W.length);for(;L.length;)L.pop()();z=!1,D=!1,B.clear()}}function K(e){if(null!==e.fragment){e.update(),s(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(q)}}const J=new Set;let F;function H(){F={r:0,c:[],p:F}}function Y(){F.r||s(F.c),F=F.p}function Q(e,t){e&&e.i&&(J.delete(e),e.i(t))}function X(e,t,n,o){if(e&&e.o){if(J.has(e))return;J.add(e),F.c.push(()=>{J.delete(e),o&&(n&&e.d(1),o())}),e.o(t)}}function Z(e){e&&e.c()}function ee(e,t,n){const{fragment:r,on_mount:i,on_destroy:c,after_update:u}=e.$$;r&&r.m(t,n),q(()=>{const t=i.map(o).filter(l);c?c.push(...t):s(t),e.$$.on_mount=[]}),u.forEach(q)}function te(e,t){const n=e.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function ne(e,t){-1===e.$$.dirty[0]&&(W.push(e),z||(z=!0,M.then(V)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function oe(t,n,o,l,i,c,u=[-1]){const a=G;I(t);const f=n.props||{},d=t.$$={fragment:null,ctx:null,props:c,update:e,not_equal:i,bound:r(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(a?a.$$.context:[]),callbacks:r(),dirty:u,skip_bound:!1};let p=!1;if(d.ctx=o?o(t,f,(e,n,...o)=>{const r=o.length?o[0]:n;return d.ctx&&i(d.ctx[e],d.ctx[e]=r)&&(!d.skip_bound&&d.bound[e]&&d.bound[e](r),p&&ne(t,e)),n}):[],d.update(),p=!0,s(d.before_update),d.fragment=!!l&&l(d.ctx),n.target){if(n.hydrate){const e=function(e){return Array.from(e.childNodes)}(n.target);d.fragment&&d.fragment.l(e),e.forEach(g)}else d.fragment&&d.fragment.c();n.intro&&Q(t.$$.fragment),ee(t,n.target,n.anchor),V()}I(a)}class re{$destroy(){te(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const se=[];function le(t,n=e){let o;const r=[];function s(e){if(i(t,e)&&(t=e,o)){const e=!se.length;for(let e=0;e<r.length;e+=1){const n=r[e];n[1](),se.push(n,t)}if(e){for(let e=0;e<se.length;e+=2)se[e][0](se[e+1]);se.length=0}}}return{set:s,update:function(e){s(e(t))},subscribe:function(l,i=e){const c=[l,i];return r.push(c),1===r.length&&(o=n(s)||e),l(t),()=>{const e=r.indexOf(c);-1!==e&&r.splice(e,1),0===r.length&&(o(),o=null)}}}}const ie=le(new Map),ce=le("");function ue(t){let n,o,r,s,l,i;return{c(){n=v("div"),o=v("img"),s=w(),l=v("p"),i=b(t[0]),k(o,"class","is-96x96"),k(o,"alt","user pic"),o.src!==(r=t[1])&&k(o,"src",r),k(l,"class","has-text-centered"),k(n,"class","svelte-ul5ug2")},m(e,t){h(e,n,t),m(n,o),m(n,s),m(n,l),m(l,i)},p(e,[t]){1&t&&C(i,e[0])},i:e,o:e,d(e){e&&g(n)}}}function ae(e,t,n){let o;c(e,ie,e=>n(2,o=e));let{username:r}=t,s=o.get(r).img_src;return e.$$set=e=>{"username"in e&&n(0,r=e.username)},[r,s]}class fe extends re{constructor(e){super(),oe(this,e,ae,ue,i,{username:0})}}function de(t){let n,o,r,l,i,c,u,a,f,d,p,$,_,b,y,S,C,A,T,N;return{c(){n=v("div"),o=v("div"),r=v("label"),r.textContent="Username",l=w(),i=v("div"),c=v("input"),u=w(),a=v("div"),f=v("label"),f.textContent="Image url",d=w(),p=v("div"),$=v("input"),_=w(),b=v("div"),y=v("label"),y.textContent=" ",S=w(),C=v("div"),A=v("button"),A.textContent="Login",k(r,"for","username-input"),k(r,"class","label"),k(c,"id","username-input"),k(c,"class","input"),k(c,"type","text"),k(c,"placeholder","username"),c.required=!0,k(i,"class","control"),k(o,"class","field column"),k(f,"for","image-url-input"),k(f,"class","label"),k($,"id","image-url-input"),k($,"class","input"),k($,"type","url"),$.required=!0,k(p,"class","control"),k(a,"class","field column"),k(y,"for","login-button"),k(y,"class","label"),k(A,"id","login-button"),k(A,"class","button is-link"),k(C,"class","control"),k(b,"class","field column is-narrow"),k(n,"class","columns")},m(e,s){h(e,n,s),m(n,o),m(o,r),m(o,l),m(o,i),m(i,c),E(c,t[0]),m(n,u),m(n,a),m(a,f),m(a,d),m(a,p),m(p,$),E($,t[1]),m(n,_),m(n,b),m(b,y),m(b,S),m(b,C),m(C,A),T||(N=[x(c,"input",t[3]),x($,"input",t[4]),x(A,"click",t[2])],T=!0)},p(e,[t]){1&t&&c.value!==e[0]&&E(c,e[0]),2&t&&E($,e[1])},i:e,o:e,d(e){e&&g(n),T=!1,s(N)}}}function pe(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function l(e){try{c(o.next(e))}catch(e){s(e)}}function i(e){try{c(o.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,i)}c((o=o.apply(e,t||[])).next())}))};const r=R();let s="";let l=["https://a.thumbs.redditmedia.com/kIpBoUR8zJLMQlF8azhN-kSBsjVUidHjvZNLuHDONm8.png","https://abs.twimg.com/sticky/default_profile_images/default_profile_400x400.png","https://styles.redditmedia.com/t5_2qhr7/styles/communityIcon_zqe9mgigjpi01.png","https://avatars1.githubusercontent.com/u/6978200","https://avatars2.githubusercontent.com/u/1506147"][Math.floor(5*Math.random())];function i(e){n(0,s=e.username||e.first_name+" "+e.last_name),n(1,l=e.photo_url||l),console.log("Logged in as "+e.first_name+" "+e.last_name+" ("+e.id+(e.username?", @"+e.username:"")+")"),console.log("Image src: "+l),r("login",{username:s,img_src:l})}var c;return c=()=>o(void 0,void 0,void 0,(function*(){window.onTelegramAuth=i})),O().$$.on_mount.push(c),[s,l,function(){console.log("dispatching"),r("login",{username:s,img_src:l})},function(){s=this.value,n(0,s)},function(){l=this.value,n(1,l)}]}class me extends re{constructor(e){super(),oe(this,e,pe,de,i,{})}}class he{constructor(){this.onMessage=e=>{},this.websocket=null}setUp(e,t){this.websocket=new WebSocket(`ws://localhost:8000/ws/${e}?img=${encodeURIComponent(t)}`),this.websocket.onmessage=e=>{console.log(e),console.log("got data:",e.data),this.onMessage(JSON.parse(e.data))}}sendObject(e){null!==this.websocket?this.websocket.send(JSON.stringify(e)):console.error("Can't send without websocket")}}function ge(e,t,n){const o=e.slice();return o[11]=t[n].stroke,o[12]=t[n].width,o[13]=t[n].points,o}function $e(e){let t,n;return{c(){t=_("polyline"),A(t,"fill","none"),A(t,"stroke",e[11]),A(t,"stroke-width",e[12]),k(t,"points",n=e[13]),k(t,"stroke-linecap","round"),k(t,"stroke-linejoin","round"),k(t,"class","svelte-1kiv9qh")},m(e,n){h(e,t,n)},p(e,o){1&o&&A(t,"stroke",e[11]),1&o&&A(t,"stroke-width",e[12]),1&o&&n!==(n=e[13])&&k(t,"points",n)},d(e){e&&g(t)}}}function ve(e){let t,n,o,r,l,i,c,u,a,f,d,p,$,_,y,C,A,N,j,G,I,O,R,W;return{c(){t=v("div"),n=v("label"),o=b("Width:\n      "),r=v("input"),l=w(),i=v("input"),c=b("\n      Color:\n      "),u=v("select"),a=v("option"),a.textContent="red",f=v("option"),f.textContent="orange",d=v("option"),d.textContent="yellow",p=v("option"),p.textContent="green",$=v("option"),$.textContent="cyan",_=v("option"),_.textContent="blue",y=v("option"),y.textContent="purple",C=v("option"),C.textContent="pink",A=v("option"),A.textContent="white",N=v("option"),N.textContent="black",j=v("option"),j.textContent="gray",G=v("option"),G.textContent="brown",I=w(),O=v("button"),O.textContent="undo",k(r,"type","number"),k(r,"min","1"),k(r,"max","30"),k(i,"type","range"),k(i,"min","1"),k(i,"max","30"),a.__value="red",a.value=a.__value,f.__value="orange",f.value=f.__value,d.__value="yellow",d.value=d.__value,p.__value="green",p.value=p.__value,$.__value="cyan",$.value=$.__value,_.__value="blue",_.value=_.__value,y.__value="purple",y.value=y.__value,C.__value="pink",C.value=C.__value,A.__value="white",A.value=A.__value,N.__value="black",N.value=N.__value,j.__value="gray",j.value=j.__value,G.__value="brown",G.value=G.__value,void 0===e[2].stroke&&q(()=>e[8].call(u)),k(t,"class","controls svelte-1kiv9qh")},m(s,g){h(s,t,g),m(t,n),m(n,o),m(n,r),E(r,e[2].width),m(n,l),m(n,i),E(i,e[2].width),m(n,c),m(n,u),m(u,a),m(u,f),m(u,d),m(u,p),m(u,$),m(u,_),m(u,y),m(u,C),m(u,A),m(u,N),m(u,j),m(u,G),T(u,e[2].stroke),m(n,I),m(n,O),R||(W=[x(r,"input",e[6]),x(i,"change",e[7]),x(i,"input",e[7]),x(u,"change",e[8]),x(O,"click",e[9])],R=!0)},p(e,t){4&t&&S(r.value)!==e[2].width&&E(r,e[2].width),4&t&&E(i,e[2].width),4&t&&T(u,e[2].stroke)},d(e){e&&g(t),R=!1,s(W)}}}function _e(t){let n,o,r,l,i,c,u,a=t[0],f=[];for(let e=0;e<a.length;e+=1)f[e]=$e(ge(t,a,e));let d=t[1]&&ve(t);return{c(){n=_("svg");for(let e=0;e<f.length;e+=1)f[e].c();o=_("polyline"),l=w(),d&&d.c(),i=y(),A(o,"fill","none"),A(o,"stroke",t[2].stroke),A(o,"stroke-width",t[2].width),k(o,"points",r=t[2].points),k(o,"stroke-linecap","round"),k(o,"stroke-linejoin","round"),k(o,"class","svelte-1kiv9qh"),k(n,"width","800"),k(n,"height","600"),k(n,"class","svelte-1kiv9qh")},m(e,r){h(e,n,r);for(let e=0;e<f.length;e+=1)f[e].m(n,null);m(n,o),h(e,l,r),d&&d.m(e,r),h(e,i,r),c||(u=[x(n,"mousemove",t[5]),x(n,"mouseup",t[3]),x(n,"mousedown",t[4]),x(n,"mouseleave",t[3])],c=!0)},p(e,[t]){if(1&t){let r;for(a=e[0],r=0;r<a.length;r+=1){const s=ge(e,a,r);f[r]?f[r].p(s,t):(f[r]=$e(s),f[r].c(),f[r].m(n,o))}for(;r<f.length;r+=1)f[r].d(1);f.length=a.length}4&t&&A(o,"stroke",e[2].stroke),4&t&&A(o,"stroke-width",e[2].width),4&t&&r!==(r=e[2].points)&&k(o,"points",r),e[1]?d?d.p(e,t):(d=ve(e),d.c(),d.m(i.parentNode,i)):d&&(d.d(1),d=null)},i:e,o:e,d(e){e&&g(n),$(f,e),e&&g(l),d&&d.d(e),e&&g(i),c=!1,s(u)}}}function be(e,t,n){let{lines:o=[]}=t,{editable:r=!0}=t,s={stroke:"red",width:2,points:""},l=!1;return e.$$set=e=>{"lines"in e&&n(0,o=e.lines),"editable"in e&&n(1,r=e.editable)},[o,r,s,function(){l&&(l=!1,s.points.split(" ").length<2||(o.push({stroke:s.stroke,width:s.width,points:s.points}),n(0,o),n(2,s.points="",s)))},function(){r&&(l=!0)},function(e){l&&n(2,s.points+=" "+e.offsetX+","+e.offsetY,s)},function(){s.width=S(this.value),n(2,s)},function(){s.width=S(this.value),n(2,s)},function(){s.stroke=N(this),n(2,s)},()=>{o.length>0&&n(0,o=o.slice(0,o.length-1))}]}class we extends re{constructor(e){super(),oe(this,e,be,_e,i,{lines:0,editable:1})}}function ye(e){return"[object Date]"===Object.prototype.toString.call(e)}function xe(e,t){if(e===t||e!=e)return()=>e;const n=typeof e;if(n!==typeof t||Array.isArray(e)!==Array.isArray(t))throw new Error("Cannot interpolate values of different type");if(Array.isArray(e)){const n=t.map((t,n)=>xe(e[n],t));return e=>n.map(t=>t(e))}if("object"===n){if(!e||!t)throw new Error("Object cannot be null");if(ye(e)&&ye(t)){e=e.getTime();const n=(t=t.getTime())-e;return t=>new Date(e+t*n)}const n=Object.keys(t),o={};return n.forEach(n=>{o[n]=xe(e[n],t[n])}),e=>{const t={};return n.forEach(n=>{t[n]=o[n](e)}),t}}if("number"===n){const n=t-e;return t=>e+t*n}throw new Error(`Cannot interpolate ${n} values`)}function ke(e,o={}){const r=le(e);let s,l=e;function i(i,c){if(null==e)return r.set(e=i),Promise.resolve();l=i;let u=s,m=!1,{delay:h=0,duration:g=400,easing:$=t,interpolate:v=xe}=n(n({},o),c);if(0===g)return u&&(u.abort(),u=null),r.set(e=l),Promise.resolve();const _=a()+h;let b;return s=function(e){let t;return 0===d.size&&f(p),{promise:new Promise(n=>{d.add(t={c:e,f:n})}),abort(){d.delete(t)}}}(t=>{if(t<_)return!0;m||(b=v(e,i),"function"==typeof g&&(g=g(e,i)),m=!0),u&&(u.abort(),u=null);const n=t-_;return n>g?(r.set(e=i),!1):(r.set(e=b($(n/g))),!0)}),s.promise}return{set:i,update:(t,n)=>i(t(l,e),n),subscribe:r.subscribe}}const Se=["fake moon landing","80% certain","large hadron collider","second date","starry night","LSD trip","colonizing mars","friendly couchsurfer","missed high five","Harambe The Pirate Gorilla","Embarassing childhood memories","Banks with tanks","Magic internet money","Alligator eating ice cream","Confused cat","Muslim Mona Lisa","Arnold Schwartznegger","Meme economy","Cremino vs Croccante","La Sfinge","Karl Marx birthday","Triple rainbow","La terra promessa","Mirror","Running dog","Leopards saving the city","Orzo Bruno","confused eggplant","Empathy","Ancient Greece","La stanza più remota della torre più alta","Bread stapled to a tree","Elon musk children","Portare a spasso tartaruga","passeggiare a Pisa con una pecora","parrucchiere che si finge idraulico","mouth full of marbles","dumplings","salsa di soia","tiny tiny sled dogs","french jedi","purse full of dreams","life spiraling out of control","planet of the babies","I'm not so sure about this hitchhiker","imposter","practice kiss","social media manager","new years resolution","End of quarantena party","Playing with spoons","Poisoned toothpaste","Giant cat","a wheelchair for six","trump fart","pubblicità della tim","parrucchiere di mattarella","il cuore immacolato di maria","autocertificazione","lavatrice occupata","hercules","constipated harry potter"];function Ce(e){let t,n,o,r,s,l,i,c,u,a,f,d,p,$,_,y;function S(t){e[6].call(null,t)}let E={};return void 0!==e[0]&&(E.lines=e[0]),o=new we({props:E}),U.push(()=>function(e,t,n){const o=e.$$.props[t];void 0!==o&&(e.$$.bound[o]=n,n(e.$$.ctx[o]))}(o,"lines",S)),{c(){t=v("h1"),t.textContent=""+e[3],n=w(),Z(o.$$.fragment),s=w(),l=v("h1"),i=b(e[1]),c=w(),u=v("progress"),a=w(),f=v("button"),d=b("Done!"),k(t,"class","is-title has-text-centered svelte-ccjhbj"),k(l,"class","has-text-centered svelte-ccjhbj"),k(u,"class","progress svelte-ccjhbj"),u.value=e[2],j(u,"is-success",e[2]<.5),j(u,"is-warning",e[2]>=.5&&e[2]<.8),j(u,"is-danger",e[2]>=.8),f.disabled=p=0===e[0].length,k(f,"class","svelte-ccjhbj")},m(r,p){h(r,t,p),h(r,n,p),ee(o,r,p),h(r,s,p),h(r,l,p),m(l,i),h(r,c,p),h(r,u,p),h(r,a,p),h(r,f,p),m(f,d),$=!0,_||(y=x(f,"click",e[5]),_=!0)},p(e,[t]){const n={};var s;!r&&1&t&&(r=!0,n.lines=e[0],s=()=>r=!1,L.push(s)),o.$set(n),(!$||2&t)&&C(i,e[1]),(!$||4&t)&&(u.value=e[2]),4&t&&j(u,"is-success",e[2]<.5),4&t&&j(u,"is-warning",e[2]>=.5&&e[2]<.8),4&t&&j(u,"is-danger",e[2]>=.8),(!$||1&t&&p!==(p=0===e[0].length))&&(f.disabled=p)},i(e){$||(Q(o.$$.fragment,e),$=!0)},o(e){X(o.$$.fragment,e),$=!1},d(e){e&&g(t),e&&g(n),te(o,e),e&&g(s),e&&g(l),e&&g(c),e&&g(u),e&&g(a),e&&g(f),_=!1,y()}}}function Ee(e,t,n){let o;const r=R(),s=Se[Math.floor(Math.random()*Se.length)].toUpperCase();let{lines:l=[]}=t;const i=ke(0,{duration:101e3});c(e,i,e=>n(2,o=e));let u,a=!1,f=function(){a||(i.set(1),confirm("Send picture?")&&(r("sendPicture",{lines:l,prompt:s}),a=!0))};return i.set(1).then(f),e.$$set=e=>{"lines"in e&&n(0,l=e.lines)},e.$$.update=()=>{4&e.$$.dirty&&n(1,u=Math.floor(101*(1-o)))},[l,u,o,s,i,f,function(e){l=e,n(0,l)}]}class Ae extends re{constructor(e){super(),oe(this,e,Ee,Ce,i,{lines:0})}}function Te(e,t,n){const o=e.slice();return o[9]=t[n],o}function Ne(e,t,n){const o=e.slice();return o[28]=t[n],o}function je(e,t,n){const o=e.slice();return o[9]=t[n],o}function Ge(e,t,n){const o=e.slice();return o[8]=t[n],o}function Ie(e){let t;return{c(){t=v("h1"),t.textContent="Scores:",k(t,"class","is-title has-text-centered svelte-uoexnu")},m(e,n){h(e,t,n)},d(e){e&&g(t)}}}function Oe(e){let t;return{c(){t=v("h1"),t.textContent="Pick your guess for:",k(t,"class","is-title has-text-centered svelte-uoexnu")},m(e,n){h(e,t,n)},d(e){e&&g(t)}}}function Re(e){let t;return{c(){t=v("h1"),t.textContent="Type your guess for:",k(t,"class","is-title has-text-centered svelte-uoexnu")},m(e,n){h(e,t,n)},d(e){e&&g(t)}}}function We(t){let n,o=t[5],r=[];for(let e=0;e<o.length;e+=1)r[e]=Le(Te(t,o,e));return{c(){n=v("ul");for(let e=0;e<r.length;e+=1)r[e].c()},m(e,t){h(e,n,t);for(let e=0;e<r.length;e+=1)r[e].m(n,null)},p(e,t){if(32&t[0]){let s;for(o=e[5],s=0;s<o.length;s+=1){const l=Te(e,o,s);r[s]?r[s].p(l,t):(r[s]=Le(l),r[s].c(),r[s].m(n,null))}for(;s<r.length;s+=1)r[s].d(1);r.length=o.length}},i:e,o:e,d(e){e&&g(n),$(r,e)}}}function Ue(e){let t,n,o,r;const s=[ze,Me],l=[];function i(e,t){return e[3]?0:1}return t=i(e),n=l[t]=s[t](e),{c(){n.c(),o=y()},m(e,n){l[t].m(e,n),h(e,o,n),r=!0},p(e,r){let c=t;t=i(e),t===c?l[t].p(e,r):(H(),X(l[c],1,1,()=>{l[c]=null}),Y(),n=l[t],n||(n=l[t]=s[t](e),n.c()),Q(n,1),n.m(o.parentNode,o))},i(e){r||(Q(n),r=!0)},o(e){X(n),r=!1},d(e){l[t].d(e),e&&g(o)}}}function Pe(e){let t,n,o,r;const s=[Ve,Be],l=[];function i(e,t){return e[2]?0:1}return t=i(e),n=l[t]=s[t](e),{c(){n.c(),o=y()},m(e,n){l[t].m(e,n),h(e,o,n),r=!0},p(e,r){let c=t;t=i(e),t===c?l[t].p(e,r):(H(),X(l[c],1,1,()=>{l[c]=null}),Y(),n=l[t],n||(n=l[t]=s[t](e),n.c()),Q(n,1),n.m(o.parentNode,o))},i(e){r||(Q(n),r=!0)},o(e){X(n),r=!1},d(e){l[t].d(e),e&&g(o)}}}function Le(e){let t,n,o=JSON.stringify(e[9])+"";return{c(){t=v("li"),n=b(o)},m(e,o){h(e,t,o),m(t,n)},p(e,t){32&t[0]&&o!==(o=JSON.stringify(e[9])+"")&&C(n,o)},d(e){e&&g(t)}}}function Me(t){let n,o,r,l,i,c=t[4],u=[];for(let e=0;e<c.length;e+=1)u[e]=qe(Ne(t,c,e));return{c(){n=v("select");for(let e=0;e<u.length;e+=1)u[e].c();o=w(),r=v("button"),r.textContent="Send!",void 0===t[9]&&q(()=>t[18].call(n)),k(r,"class","button is-info is-large")},m(e,s){h(e,n,s);for(let e=0;e<u.length;e+=1)u[e].m(n,null);T(n,t[9]),h(e,o,s),h(e,r,s),l||(i=[x(n,"change",t[18]),x(r,"click",t[12])],l=!0)},p(e,t){if(16&t[0]){let o;for(c=e[4],o=0;o<c.length;o+=1){const r=Ne(e,c,o);u[o]?u[o].p(r,t):(u[o]=qe(r),u[o].c(),u[o].m(n,null))}for(;o<u.length;o+=1)u[o].d(1);u.length=c.length}528&t[0]&&T(n,e[9])},i:e,o:e,d(e){e&&g(n),$(u,e),e&&g(o),e&&g(r),l=!1,s(i)}}}function ze(e){let t,n,o,r,s=e[5],l=[];for(let t=0;t<s.length;t+=1)l[t]=De(je(e,s,t));const i=e=>X(l[e],1,1,()=>{l[e]=null});return{c(){t=v("h2"),t.textContent="Got votes:",n=w();for(let e=0;e<l.length;e+=1)l[e].c();o=y(),k(t,"class","has-text-centered")},m(e,s){h(e,t,s),h(e,n,s);for(let t=0;t<l.length;t+=1)l[t].m(e,s);h(e,o,s),r=!0},p(e,t){if(32&t[0]){let n;for(s=e[5],n=0;n<s.length;n+=1){const r=je(e,s,n);l[n]?(l[n].p(r,t),Q(l[n],1)):(l[n]=De(r),l[n].c(),Q(l[n],1),l[n].m(o.parentNode,o))}for(H(),n=s.length;n<l.length;n+=1)i(n);Y()}},i(e){if(!r){for(let e=0;e<s.length;e+=1)Q(l[e]);r=!0}},o(e){l=l.filter(Boolean);for(let e=0;e<l.length;e+=1)X(l[e]);r=!1},d(e){e&&g(t),e&&g(n),$(l,e),e&&g(o)}}}function qe(e){let t,n,o,r=e[28].prompt+"";return{c(){t=v("option"),n=b(r),t.__value=o=e[28].prompt,t.value=t.__value},m(e,o){h(e,t,o),m(t,n)},p(e,s){16&s[0]&&r!==(r=e[28].prompt+"")&&C(n,r),16&s[0]&&o!==(o=e[28].prompt)&&(t.__value=o,t.value=t.__value)},d(e){e&&g(t)}}}function De(e){let t,n;return t=new fe({props:{username:e[9].username}}),{c(){Z(t.$$.fragment)},m(e,o){ee(t,e,o),n=!0},p(e,n){const o={};32&n[0]&&(o.username=e[9].username),t.$set(o)},i(e){n||(Q(t.$$.fragment,e),n=!0)},o(e){X(t.$$.fragment,e),n=!1},d(e){te(t,e)}}}function Be(t){let n,o,r,l,i,c,u,a,f,d;return{c(){n=v("div"),o=v("div"),r=v("input"),l=w(),i=v("div"),c=v("button"),u=b("Send!"),k(r,"class","input is-large"),k(r,"type","text"),k(r,"placeholder","Your guess"),r.required=!0,k(o,"class","control is-expanded"),k(c,"class","button is-info is-large"),c.disabled=a=0===t[8].length,k(i,"class","control"),k(n,"class","field has-addons has-addons-centered svelte-uoexnu")},m(e,s){h(e,n,s),m(n,o),m(o,r),E(r,t[8]),m(n,l),m(n,i),m(i,c),m(c,u),f||(d=[x(r,"input",t[17]),x(c,"click",t[11])],f=!0)},p(e,t){256&t[0]&&r.value!==e[8]&&E(r,e[8]),256&t[0]&&a!==(a=0===e[8].length)&&(c.disabled=a)},i:e,o:e,d(e){e&&g(n),f=!1,s(d)}}}function Ve(e){let t,n,o,r,s=e[4],l=[];for(let t=0;t<s.length;t+=1)l[t]=Ke(Ge(e,s,t));const i=e=>X(l[e],1,1,()=>{l[e]=null});return{c(){t=v("h2"),t.textContent="Got guesses:",n=w();for(let e=0;e<l.length;e+=1)l[e].c();o=y(),k(t,"class","has-text-centered")},m(e,s){h(e,t,s),h(e,n,s);for(let t=0;t<l.length;t+=1)l[t].m(e,s);h(e,o,s),r=!0},p(e,t){if(16&t[0]){let n;for(s=e[4],n=0;n<s.length;n+=1){const r=Ge(e,s,n);l[n]?(l[n].p(r,t),Q(l[n],1)):(l[n]=Ke(r),l[n].c(),Q(l[n],1),l[n].m(o.parentNode,o))}for(H(),n=s.length;n<l.length;n+=1)i(n);Y()}},i(e){if(!r){for(let e=0;e<s.length;e+=1)Q(l[e]);r=!0}},o(e){l=l.filter(Boolean);for(let e=0;e<l.length;e+=1)X(l[e]);r=!1},d(e){e&&g(t),e&&g(n),$(l,e),e&&g(o)}}}function Ke(e){let t,n;return t=new fe({props:{username:e[8].username}}),{c(){Z(t.$$.fragment)},m(e,o){ee(t,e,o),n=!0},p(e,n){const o={};16&n[0]&&(o.username=e[8].username),t.$set(o)},i(e){n||(Q(t.$$.fragment,e),n=!0)},o(e){X(t.$$.fragment,e),n=!1},d(e){te(t,e)}}}function Je(e){let t,n,o,r,s,l,i,c,u,a,f;function d(e,t){return e[1]===e[10].WRITE_GUESS?Re:e[1]===e[10].PICK_GUESS?Oe:Ie}let p=d(e),$=p(e);n=new we({props:{lines:e[0].lines,editable:!1}});const _=[Pe,Ue,We],y=[];function x(e,t){return e[1]===e[10].WRITE_GUESS?0:e[1]===e[10].PICK_GUESS?1:e[1]===e[10].SCORE?2:-1}return~(r=x(e))&&(s=y[r]=_[r](e)),{c(){$.c(),t=w(),Z(n.$$.fragment),o=w(),s&&s.c(),l=w(),i=v("progress"),c=w(),u=v("h1"),a=b(e[6]),k(i,"class","progress svelte-uoexnu"),i.value=e[7],j(i,"is-success",e[7]<.5),j(i,"is-warning",e[7]>=.5&&e[7]<.8),j(i,"is-danger",e[7]>=.8),k(u,"class","has-text-centered svelte-uoexnu")},m(e,s){$.m(e,s),h(e,t,s),ee(n,e,s),h(e,o,s),~r&&y[r].m(e,s),h(e,l,s),h(e,i,s),h(e,c,s),h(e,u,s),m(u,a),f=!0},p(e,o){p!==(p=d(e))&&($.d(1),$=p(e),$&&($.c(),$.m(t.parentNode,t)));const c={};1&o[0]&&(c.lines=e[0].lines),n.$set(c);let u=r;r=x(e),r===u?~r&&y[r].p(e,o):(s&&(H(),X(y[u],1,1,()=>{y[u]=null}),Y()),~r?(s=y[r],s||(s=y[r]=_[r](e),s.c()),Q(s,1),s.m(l.parentNode,l)):s=null),(!f||128&o[0])&&(i.value=e[7]),128&o[0]&&j(i,"is-success",e[7]<.5),128&o[0]&&j(i,"is-warning",e[7]>=.5&&e[7]<.8),128&o[0]&&j(i,"is-danger",e[7]>=.8),(!f||64&o[0])&&C(a,e[6])},i(e){f||(Q(n.$$.fragment,e),Q(s),f=!0)},o(e){X(n.$$.fragment,e),X(s),f=!1},d(e){$.d(e),e&&g(t),te(n,e),e&&g(o),~r&&y[r].d(e),e&&g(l),e&&g(i),e&&g(c),e&&g(u)}}}function Fe(e,t,n){let o,r,s;c(e,ce,e=>n(19,o=e)),c(e,ie,e=>n(20,r=e));const l=R();let{pictures:i}=t;const u={WRITE_GUESS:"write_guess",PICK_GUESS:"pick_guess",SCORE:"scoring"};let a=i[0],f=u.WRITE_GUESS,d="",p=!1,m="",h=!1,g=[],$=[];const v=ke(0,{duration:31e3});let _;return c(e,v,e=>n(7,s=e)),0!=i.length?(n(0,a=i.pop()),n(4,g=[{prompt:a.prompt,username:a.username}]),n(5,$=[]),n(1,f=u.WRITE_GUESS),n(2,p=a.username===o),n(8,d=""),v.set(0,{duration:500}).then(()=>v.set(1)).then(()=>alert("Please send a guess!"))):alert("Oh noes! No pictures!"),e.$$set=e=>{"pictures"in e&&n(14,i=e.pictures)},e.$$.update=()=>{128&e.$$.dirty[0]&&n(6,_=Math.floor(31*(1-s)))},[a,f,p,h,g,$,_,s,d,m,u,function(){l("sendGuess",d.toUpperCase()),n(2,p=!0),v.set(1)},function(){l("sendVote",m),n(3,h=!0),v.set(1)},v,i,e=>{console.log(e),n(4,g=[...g,e]),console.log(g),g.length===r.size&&(n(3,h=o===a.username),n(1,f=u.PICK_GUESS),n(9,m=""),v.set(0,{duration:500}).then(()=>v.set(1)).then(()=>alert("Please send a vote!")))},e=>{console.log(e),n(5,$=[...$,e]),console.log($),$.length===r.size-1&&(alert("Everybody voted!"),n(1,f=u.SCORE))},function(){d=this.value,n(8,d)},function(){m=N(this),n(9,m),n(4,g)}]}class He extends re{constructor(e){super(),oe(this,e,Fe,Je,i,{pictures:14,onGuess:15,onVote:16},[-1,-1])}get onGuess(){return this.$$.ctx[15]}get onVote(){return this.$$.ctx[16]}}function Ye(e,t,n){const o=e.slice();return o[17]=t[n],o}function Qe(e,t,n){const o=e.slice();return o[14]=t[n],o}function Xe(t){let n;return{c(){n=v("h1"),n.textContent="UNKNOWN STATE AAAA",k(n,"class","title has-text-centered")},m(e,t){h(e,n,t)},p:e,i:e,o:e,d(e){e&&g(n)}}}function Ze(e){let t,n,o={pictures:e[2]};return t=new He({props:o}),e[9](t),t.$on("sendVote",e[7]),t.$on("sendGuess",e[8]),{c(){Z(t.$$.fragment)},m(e,o){ee(t,e,o),n=!0},p(e,n){const o={};4&n&&(o.pictures=e[2]),t.$set(o)},i(e){n||(Q(t.$$.fragment,e),n=!0)},o(e){X(t.$$.fragment,e),n=!1},d(n){e[9](null),te(t,n)}}}function et(e){let t,n,o,r,s=e[2],l=[];for(let t=0;t<s.length;t+=1)l[t]=rt(Ye(e,s,t));const i=e=>X(l[e],1,1,()=>{l[e]=null});return{c(){t=v("h1"),t.textContent="Waiting for other players to finish drawing, got:",n=w();for(let e=0;e<l.length;e+=1)l[e].c();o=y(),k(t,"class","title has-text-centered")},m(e,s){h(e,t,s),h(e,n,s);for(let t=0;t<l.length;t+=1)l[t].m(e,s);h(e,o,s),r=!0},p(e,t){if(4&t){let n;for(s=e[2],n=0;n<s.length;n+=1){const r=Ye(e,s,n);l[n]?(l[n].p(r,t),Q(l[n],1)):(l[n]=rt(r),l[n].c(),Q(l[n],1),l[n].m(o.parentNode,o))}for(H(),n=s.length;n<l.length;n+=1)i(n);Y()}},i(e){if(!r){for(let e=0;e<s.length;e+=1)Q(l[e]);r=!0}},o(e){l=l.filter(Boolean);for(let e=0;e<l.length;e+=1)X(l[e]);r=!1},d(e){e&&g(t),e&&g(n),$(l,e),e&&g(o)}}}function tt(t){let n,o,r,s;return r=new Ae({}),r.$on("sendPicture",t[6]),{c(){n=v("h1"),n.textContent="Let's draw!",o=w(),Z(r.$$.fragment),k(n,"class","title has-text-centered")},m(e,t){h(e,n,t),h(e,o,t),ee(r,e,t),s=!0},p:e,i(e){s||(Q(r.$$.fragment,e),s=!0)},o(e){X(r.$$.fragment,e),s=!1},d(e){e&&g(n),e&&g(o),te(r,e)}}}function nt(e){let t,n,o,r,s=e[3],l=[];for(let t=0;t<s.length;t+=1)l[t]=st(Qe(e,s,t));const i=e=>X(l[e],1,1,()=>{l[e]=null});return{c(){t=v("h1"),t.textContent="Waiting for other players",n=w(),o=v("ul");for(let e=0;e<l.length;e+=1)l[e].c();k(t,"class","title has-text-centered")},m(e,s){h(e,t,s),h(e,n,s),h(e,o,s);for(let e=0;e<l.length;e+=1)l[e].m(o,null);r=!0},p(e,t){if(8&t){let n;for(s=e[3],n=0;n<s.length;n+=1){const r=Qe(e,s,n);l[n]?(l[n].p(r,t),Q(l[n],1)):(l[n]=st(r),l[n].c(),Q(l[n],1),l[n].m(o,null))}for(H(),n=s.length;n<l.length;n+=1)i(n);Y()}},i(e){if(!r){for(let e=0;e<s.length;e+=1)Q(l[e]);r=!0}},o(e){l=l.filter(Boolean);for(let e=0;e<l.length;e+=1)X(l[e]);r=!1},d(e){e&&g(t),e&&g(n),e&&g(o),$(l,e)}}}function ot(t){let n,o;return n=new me({}),n.$on("login",t[5]),{c(){Z(n.$$.fragment)},m(e,t){ee(n,e,t),o=!0},p:e,i(e){o||(Q(n.$$.fragment,e),o=!0)},o(e){X(n.$$.fragment,e),o=!1},d(e){te(n,e)}}}function rt(e){let t,n;return t=new fe({props:{username:e[17].username}}),{c(){Z(t.$$.fragment)},m(e,o){ee(t,e,o),n=!0},p(e,n){const o={};4&n&&(o.username=e[17].username),t.$set(o)},i(e){n||(Q(t.$$.fragment,e),n=!0)},o(e){X(t.$$.fragment,e),n=!1},d(e){te(t,e)}}}function st(e){let t,n;return t=new fe({props:{username:e[14][0]}}),{c(){Z(t.$$.fragment)},m(e,o){ee(t,e,o),n=!0},p(e,n){const o={};8&n&&(o.username=e[14][0]),t.$set(o)},i(e){n||(Q(t.$$.fragment,e),n=!0)},o(e){X(t.$$.fragment,e),n=!1},d(e){te(t,e)}}}function lt(e){let t,n,o,r;const s=[ot,nt,tt,et,Ze,Xe],l=[];function i(e,t){return e[0]===e[4].LOGIN?0:e[0]===e[4].WAIT_START?1:e[0]===e[4].DRAW?2:e[0]===e[4].WAIT_DRAWERS?3:e[0]===e[4].GUESS?4:5}return n=i(e),o=l[n]=s[n](e),{c(){t=v("div"),o.c(),k(t,"class","container svelte-11dnclf")},m(e,o){h(e,t,o),l[n].m(t,null),r=!0},p(e,[r]){let c=n;n=i(e),n===c?l[n].p(e,r):(H(),X(l[c],1,1,()=>{l[c]=null}),Y(),o=l[n],o||(o=l[n]=s[n](e),o.c()),Q(o,1),o.m(t,null))},i(e){r||(Q(o),r=!0)},o(e){X(o),r=!1},d(e){e&&g(t),l[n].d()}}}function it(e,t,n){let o,r;c(e,ie,e=>n(12,o=e)),c(e,ce,e=>n(13,r=e));const s={LOGIN:"login",WAIT_START:"wait_start",DRAW:"draw",WAIT_DRAWERS:"wait_drawers",GUESS:"guess"};let l,i,u,a=s.LOGIN,f=new he,d=[];return f.onMessage=e=>{switch(console.log(e.type),console.log(e),e.type){case"new_user":const t={username:e.username,img_src:e.img_src};ie.update(e=>(e.set(t.username,{score:0,img_src:t.img_src}),console.log([...e]),e)),t.username===r&&(n(0,a=s.WAIT_START),console.log("Connected: ",e));break;case"old_users":const l=e.users.map(e=>({score:0,username:e[0],img_src:e[1]}));ie.update(e=>{for(let t of l)e.set(t.username,{score:0,img_src:t.img_src});return e});break;case"start_game":n(0,a=s.DRAW);break;case"picture":n(2,d=[...d,{username:e.username,lines:e.lines,prompt:e.prompt}]),d.sort(),console.log(d),d.length===o.size&&n(0,a=s.GUESS);break;case"guessed_prompt":i.onGuess(e);break;case"voted_prompt":i.onVote(e);break;default:alert("Unknown type, see console")}},e.$$.update=()=>{4096&e.$$.dirty&&n(3,u=[...o])},[a,i,d,u,s,function(e){n(0,a=s.WAIT_START);let t=e.detail.username;l=e.detail.img_src,ce.set(t),console.log("Logged in: ",e.detail);let o=document.getElementById("telegram-login-minnybot");(null==o?void 0:o.parentNode)&&o.parentNode.removeChild(o),f.setUp(t,l)},function(e){console.log("sendPicture message",e),n(0,a=s.WAIT_DRAWERS),null==f||f.sendObject({type:"picture",lines:e.detail.lines,prompt:e.detail.prompt})},function(e){console.log("sendVote message",e),null==f||f.sendObject({type:"voted_prompt",prompt:e.detail})},function(e){console.log("sendGuess message",e),null==f||f.sendObject({type:"guessed_prompt",prompt:e.detail})},function(e){U[e?"unshift":"push"](()=>{i=e,n(1,i)})}]}return new class extends re{constructor(e){super(),oe(this,e,it,lt,i,{})}}({target:document.body,props:{}})}();
//# sourceMappingURL=bundle.js.map
