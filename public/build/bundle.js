var app=function(){"use strict";function e(){}const t=e=>e;function n(e,t){for(const n in t)e[n]=t[n];return e}function o(e){return e()}function s(){return Object.create(null)}function r(e){e.forEach(o)}function l(e){return"function"==typeof e}function i(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function c(t,n,o){t.$$.on_destroy.push(function(t,...n){if(null==t)return e;const o=t.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}(n,o))}const u="undefined"!=typeof window;let a=u?()=>window.performance.now():()=>Date.now(),p=u?e=>requestAnimationFrame(e):e;const d=new Set;function f(e){d.forEach(t=>{t.c(e)||(d.delete(t),t.f())}),0!==d.size&&p(f)}function m(e,t){e.appendChild(t)}function g(e,t,n){e.insertBefore(t,n||null)}function h(e){e.parentNode.removeChild(e)}function _(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function v(e){return document.createElement(e)}function $(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function b(e){return document.createTextNode(e)}function w(){return b(" ")}function k(){return b("")}function x(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function y(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function S(e){return""===e?null:+e}function E(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function C(e,t){e.value=null==t?"":t}function A(e,t,n,o){e.style.setProperty(t,n,o?"important":"")}function I(e,t){for(let n=0;n<e.options.length;n+=1){const o=e.options[n];if(o.__value===t)return void(o.selected=!0)}}function R(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}function N(e,t,n){e.classList[n?"add":"remove"](t)}let T;function G(e){T=e}function O(){if(!T)throw new Error("Function called outside component initialization");return T}function j(){const e=O();return(t,n)=>{const o=e.$$.callbacks[t];if(o){const s=function(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}(t,n);o.slice().forEach(t=>{t.call(e,s)})}}}const U=[],W=[],L=[],D=[],P=Promise.resolve();let M=!1;function q(e){L.push(e)}let B=!1;const z=new Set;function V(){if(!B){B=!0;do{for(let e=0;e<U.length;e+=1){const t=U[e];G(t),K(t.$$)}for(G(null),U.length=0;W.length;)W.pop()();for(let e=0;e<L.length;e+=1){const t=L[e];z.has(t)||(z.add(t),t())}L.length=0}while(U.length);for(;D.length;)D.pop()();M=!1,B=!1,z.clear()}}function K(e){if(null!==e.fragment){e.update(),r(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(q)}}const H=new Set;let F;function J(){F={r:0,c:[],p:F}}function X(){F.r||r(F.c),F=F.p}function Y(e,t){e&&e.i&&(H.delete(e),e.i(t))}function Q(e,t,n,o){if(e&&e.o){if(H.has(e))return;H.add(e),F.c.push(()=>{H.delete(e),o&&(n&&e.d(1),o())}),e.o(t)}}function Z(e){e&&e.c()}function ee(e,t,n){const{fragment:s,on_mount:i,on_destroy:c,after_update:u}=e.$$;s&&s.m(t,n),q(()=>{const t=i.map(o).filter(l);c?c.push(...t):r(t),e.$$.on_mount=[]}),u.forEach(q)}function te(e,t){const n=e.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function ne(e,t){-1===e.$$.dirty[0]&&(U.push(e),M||(M=!0,P.then(V)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function oe(t,n,o,l,i,c,u=[-1]){const a=T;G(t);const p=n.props||{},d=t.$$={fragment:null,ctx:null,props:c,update:e,not_equal:i,bound:s(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(a?a.$$.context:[]),callbacks:s(),dirty:u,skip_bound:!1};let f=!1;if(d.ctx=o?o(t,p,(e,n,...o)=>{const s=o.length?o[0]:n;return d.ctx&&i(d.ctx[e],d.ctx[e]=s)&&(!d.skip_bound&&d.bound[e]&&d.bound[e](s),f&&ne(t,e)),n}):[],d.update(),f=!0,r(d.before_update),d.fragment=!!l&&l(d.ctx),n.target){if(n.hydrate){const e=function(e){return Array.from(e.childNodes)}(n.target);d.fragment&&d.fragment.l(e),e.forEach(h)}else d.fragment&&d.fragment.c();n.intro&&Y(t.$$.fragment),ee(t,n.target,n.anchor),V()}G(a)}class se{$destroy(){te(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const re=[];function le(t,n=e){let o;const s=[];function r(e){if(i(t,e)&&(t=e,o)){const e=!re.length;for(let e=0;e<s.length;e+=1){const n=s[e];n[1](),re.push(n,t)}if(e){for(let e=0;e<re.length;e+=2)re[e][0](re[e+1]);re.length=0}}}return{set:r,update:function(e){r(e(t))},subscribe:function(l,i=e){const c=[l,i];return s.push(c),1===s.length&&(o=n(r)||e),l(t),()=>{const e=s.indexOf(c);-1!==e&&s.splice(e,1),0===s.length&&(o(),o=null)}}}}const ie=le(new Map),ce=le(""),ue=le("");function ae(t){let n,o,s,r,l,i;return{c(){n=v("div"),o=v("img"),r=w(),l=v("p"),i=b(t[0]),y(o,"class","is-96x96"),y(o,"alt","user pic"),o.src!==(s=t[1])&&y(o,"src",s),y(l,"class","has-text-centered"),y(n,"class","svelte-ul5ug2")},m(e,t){g(e,n,t),m(n,o),m(n,r),m(n,l),m(l,i)},p(e,[t]){1&t&&E(i,e[0])},i:e,o:e,d(e){e&&h(n)}}}function pe(e,t,n){let o;var s;c(e,ie,e=>n(3,o=e));let{username:r}=t,l=null===(s=o.get(r))||void 0===s?void 0:s.img_src;return e.$$set=e=>{"username"in e&&n(0,r=e.username)},[r,l]}class de extends se{constructor(e){super(),oe(this,e,pe,ae,i,{username:0})}}function fe(t){let n,o,s,l,i,c,u,a,p,d,f,_,$,b,k,S,E,A,I,R,N,T,G,O,j,U;return{c(){n=v("div"),o=v("div"),s=v("input"),l=w(),i=v("pre"),i.textContent="No telegram fallback, please don't use this",c=w(),u=v("div"),a=v("div"),p=v("label"),p.textContent="Username",d=w(),f=v("div"),_=v("input"),$=w(),b=v("div"),k=v("label"),k.textContent="Image url",S=w(),E=v("div"),A=v("input"),I=w(),R=v("div"),N=v("label"),N.textContent="Â ",T=w(),G=v("div"),O=v("button"),O.textContent="Login",y(s,"class","input is-large"),y(s,"type","text"),y(s,"placeholder","Your prompt"),s.required=!0,y(o,"class","control is-expanded"),y(n,"class","field"),y(p,"for","username-input"),y(p,"class","label"),y(_,"id","username-input"),y(_,"class","input"),y(_,"type","text"),y(_,"placeholder","username"),_.required=!0,y(f,"class","control"),y(a,"class","field column"),y(k,"for","image-url-input"),y(k,"class","label"),y(A,"id","image-url-input"),y(A,"class","input"),y(A,"type","url"),A.required=!0,y(E,"class","control"),y(b,"class","field column"),y(N,"for","login-button"),y(N,"class","label"),y(O,"id","login-button"),y(O,"class","button is-link"),y(G,"class","control"),y(R,"class","field column is-narrow"),y(u,"class","columns")},m(e,r){g(e,n,r),m(n,o),m(o,s),C(s,t[1]),g(e,l,r),g(e,i,r),g(e,c,r),g(e,u,r),m(u,a),m(a,p),m(a,d),m(a,f),m(f,_),C(_,t[0]),m(u,$),m(u,b),m(b,k),m(b,S),m(b,E),m(E,A),C(A,t[2]),m(u,I),m(u,R),m(R,N),m(R,T),m(R,G),m(G,O),j||(U=[x(s,"input",t[4]),x(_,"input",t[5]),x(A,"input",t[6]),x(O,"click",t[3])],j=!0)},p(e,[t]){2&t&&s.value!==e[1]&&C(s,e[1]),1&t&&_.value!==e[0]&&C(_,e[0]),4&t&&C(A,e[2])},i:e,o:e,d(e){e&&h(n),e&&h(l),e&&h(i),e&&h(c),e&&h(u),j=!1,r(U)}}}function me(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(s,r){function l(e){try{c(o.next(e))}catch(e){r(e)}}function i(e){try{c(o.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,i)}c((o=o.apply(e,t||[])).next())}))};const s=j();let r="",l="";let i=["https://a.thumbs.redditmedia.com/kIpBoUR8zJLMQlF8azhN-kSBsjVUidHjvZNLuHDONm8.png","https://abs.twimg.com/sticky/default_profile_images/default_profile_400x400.png","https://styles.redditmedia.com/t5_2qhr7/styles/communityIcon_zqe9mgigjpi01.png","https://avatars1.githubusercontent.com/u/6978200","https://avatars2.githubusercontent.com/u/1506147"][Math.floor(5*Math.random())];function c(e){l?(n(0,r=e.username||e.first_name+" "+e.last_name),n(2,i=e.photo_url||i),console.log("Logged in as "+e.first_name+" "+e.last_name+" ("+e.id+(e.username?", @"+e.username:"")+")"),console.log("Image src: "+i),s("login",{username:r,img_src:i,prompt:l})):alert("Write prompt first!")}var u;return u=()=>o(void 0,void 0,void 0,(function*(){window.onTelegramAuth=c})),O().$$.on_mount.push(u),[r,l,i,function(){l?(console.log("dispatching"),s("login",{username:r,img_src:i,prompt:l})):alert("Write prompt first!")},function(){l=this.value,n(1,l)},function(){r=this.value,n(0,r)},function(){i=this.value,n(2,i)}]}class ge extends se{constructor(e){super(),oe(this,e,me,fe,i,{})}}class he{constructor(){this.onMessage=e=>{},this.websocket=null}setUp(e,t,n){const o=`wss://${document.location.host}:8000/ws/${e}?prompt=${n}&img=${encodeURIComponent(t)}`;console.log(o),this.websocket=new WebSocket(o),this.websocket.onmessage=e=>{console.log(e),console.log("got data:",e.data),this.onMessage(JSON.parse(e.data))}}sendObject(e){null!==this.websocket?this.websocket.send(JSON.stringify(e)):console.error("Can't send without websocket")}}function _e(e,t,n){const o=e.slice();return o[11]=t[n].stroke,o[12]=t[n].width,o[13]=t[n].points,o}function ve(e){let t,n;return{c(){t=$("polyline"),A(t,"fill","none"),A(t,"stroke",e[11]),A(t,"stroke-width",e[12]),y(t,"points",n=e[13]),y(t,"stroke-linecap","round"),y(t,"stroke-linejoin","round"),y(t,"class","svelte-1kiv9qh")},m(e,n){g(e,t,n)},p(e,o){1&o&&A(t,"stroke",e[11]),1&o&&A(t,"stroke-width",e[12]),1&o&&n!==(n=e[13])&&y(t,"points",n)},d(e){e&&h(t)}}}function $e(e){let t,n,o,s,l,i,c,u,a,p,d,f,_,$,k,E,A,R,N,T,G,O,j,U;return{c(){t=v("div"),n=v("label"),o=b("Width:\n      "),s=v("input"),l=w(),i=v("input"),c=b("\n      Color:\n      "),u=v("select"),a=v("option"),a.textContent="red",p=v("option"),p.textContent="orange",d=v("option"),d.textContent="yellow",f=v("option"),f.textContent="green",_=v("option"),_.textContent="cyan",$=v("option"),$.textContent="blue",k=v("option"),k.textContent="purple",E=v("option"),E.textContent="pink",A=v("option"),A.textContent="white",R=v("option"),R.textContent="black",N=v("option"),N.textContent="gray",T=v("option"),T.textContent="brown",G=w(),O=v("button"),O.textContent="undo",y(s,"type","number"),y(s,"min","1"),y(s,"max","30"),y(i,"type","range"),y(i,"min","1"),y(i,"max","30"),a.__value="red",a.value=a.__value,p.__value="orange",p.value=p.__value,d.__value="yellow",d.value=d.__value,f.__value="green",f.value=f.__value,_.__value="cyan",_.value=_.__value,$.__value="blue",$.value=$.__value,k.__value="purple",k.value=k.__value,E.__value="pink",E.value=E.__value,A.__value="white",A.value=A.__value,R.__value="black",R.value=R.__value,N.__value="gray",N.value=N.__value,T.__value="brown",T.value=T.__value,void 0===e[2].stroke&&q(()=>e[8].call(u)),y(t,"class","controls svelte-1kiv9qh")},m(r,h){g(r,t,h),m(t,n),m(n,o),m(n,s),C(s,e[2].width),m(n,l),m(n,i),C(i,e[2].width),m(n,c),m(n,u),m(u,a),m(u,p),m(u,d),m(u,f),m(u,_),m(u,$),m(u,k),m(u,E),m(u,A),m(u,R),m(u,N),m(u,T),I(u,e[2].stroke),m(n,G),m(n,O),j||(U=[x(s,"input",e[6]),x(i,"change",e[7]),x(i,"input",e[7]),x(u,"change",e[8]),x(O,"click",e[9])],j=!0)},p(e,t){4&t&&S(s.value)!==e[2].width&&C(s,e[2].width),4&t&&C(i,e[2].width),4&t&&I(u,e[2].stroke)},d(e){e&&h(t),j=!1,r(U)}}}function be(t){let n,o,s,l,i,c,u,a=t[0],p=[];for(let e=0;e<a.length;e+=1)p[e]=ve(_e(t,a,e));let d=t[1]&&$e(t);return{c(){n=$("svg");for(let e=0;e<p.length;e+=1)p[e].c();o=$("polyline"),l=w(),d&&d.c(),i=k(),A(o,"fill","none"),A(o,"stroke",t[2].stroke),A(o,"stroke-width",t[2].width),y(o,"points",s=t[2].points),y(o,"stroke-linecap","round"),y(o,"stroke-linejoin","round"),y(o,"class","svelte-1kiv9qh"),y(n,"width","800"),y(n,"height","600"),y(n,"class","svelte-1kiv9qh")},m(e,s){g(e,n,s);for(let e=0;e<p.length;e+=1)p[e].m(n,null);m(n,o),g(e,l,s),d&&d.m(e,s),g(e,i,s),c||(u=[x(n,"mousemove",t[5]),x(n,"mouseup",t[3]),x(n,"mousedown",t[4]),x(n,"mouseleave",t[3])],c=!0)},p(e,[t]){if(1&t){let s;for(a=e[0],s=0;s<a.length;s+=1){const r=_e(e,a,s);p[s]?p[s].p(r,t):(p[s]=ve(r),p[s].c(),p[s].m(n,o))}for(;s<p.length;s+=1)p[s].d(1);p.length=a.length}4&t&&A(o,"stroke",e[2].stroke),4&t&&A(o,"stroke-width",e[2].width),4&t&&s!==(s=e[2].points)&&y(o,"points",s),e[1]?d?d.p(e,t):(d=$e(e),d.c(),d.m(i.parentNode,i)):d&&(d.d(1),d=null)},i:e,o:e,d(e){e&&h(n),_(p,e),e&&h(l),d&&d.d(e),e&&h(i),c=!1,r(u)}}}function we(e,t,n){let{lines:o=[]}=t,{editable:s=!0}=t,r={stroke:"red",width:2,points:""},l=!1;return e.$$set=e=>{"lines"in e&&n(0,o=e.lines),"editable"in e&&n(1,s=e.editable)},[o,s,r,function(){l&&(l=!1,r.points.split(" ").length<2||(o.push({stroke:r.stroke,width:r.width,points:r.points}),n(0,o),n(2,r.points="",r)))},function(){s&&(l=!0)},function(e){l&&n(2,r.points+=" "+e.offsetX+","+e.offsetY,r)},function(){r.width=S(this.value),n(2,r)},function(){r.width=S(this.value),n(2,r)},function(){r.stroke=R(this),n(2,r)},()=>{o.length>0&&n(0,o=o.slice(0,o.length-1))}]}class ke extends se{constructor(e){super(),oe(this,e,we,be,i,{lines:0,editable:1})}}function xe(e){return"[object Date]"===Object.prototype.toString.call(e)}function ye(e,t){if(e===t||e!=e)return()=>e;const n=typeof e;if(n!==typeof t||Array.isArray(e)!==Array.isArray(t))throw new Error("Cannot interpolate values of different type");if(Array.isArray(e)){const n=t.map((t,n)=>ye(e[n],t));return e=>n.map(t=>t(e))}if("object"===n){if(!e||!t)throw new Error("Object cannot be null");if(xe(e)&&xe(t)){e=e.getTime();const n=(t=t.getTime())-e;return t=>new Date(e+t*n)}const n=Object.keys(t),o={};return n.forEach(n=>{o[n]=ye(e[n],t[n])}),e=>{const t={};return n.forEach(n=>{t[n]=o[n](e)}),t}}if("number"===n){const n=t-e;return t=>e+t*n}throw new Error(`Cannot interpolate ${n} values`)}function Se(e,o={}){const s=le(e);let r,l=e;function i(i,c){if(null==e)return s.set(e=i),Promise.resolve();l=i;let u=r,m=!1,{delay:g=0,duration:h=400,easing:_=t,interpolate:v=ye}=n(n({},o),c);if(0===h)return u&&(u.abort(),u=null),s.set(e=l),Promise.resolve();const $=a()+g;let b;return r=function(e){let t;return 0===d.size&&p(f),{promise:new Promise(n=>{d.add(t={c:e,f:n})}),abort(){d.delete(t)}}}(t=>{if(t<$)return!0;m||(b=v(e,i),"function"==typeof h&&(h=h(e,i)),m=!0),u&&(u.abort(),u=null);const n=t-$;return n>h?(s.set(e=i),!1):(s.set(e=b(_(n/h))),!0)}),r.promise}return{set:i,update:(t,n)=>i(t(l,e),n),subscribe:s.subscribe}}function Ee(e){let t,n,o,s,r,l,i,c,u,a,p,d,f,_,$,k,S;function C(t){e[6].call(null,t)}let A={};return void 0!==e[0]&&(A.lines=e[0]),s=new ke({props:A}),W.push(()=>function(e,t,n){const o=e.$$.props[t];void 0!==o&&(e.$$.bound[o]=n,n(e.$$.ctx[o]))}(s,"lines",C)),{c(){t=v("h1"),n=b(e[1]),o=w(),Z(s.$$.fragment),l=w(),i=v("h1"),c=b(e[2]),u=w(),a=v("progress"),p=w(),d=v("button"),f=b("Done!"),y(t,"class","is-title has-text-centered svelte-ccjhbj"),y(i,"class","has-text-centered svelte-ccjhbj"),y(a,"class","progress svelte-ccjhbj"),a.value=e[3],N(a,"is-success",e[3]<.5),N(a,"is-warning",e[3]>=.5&&e[3]<.8),N(a,"is-danger",e[3]>=.8),d.disabled=_=0===e[0].length,y(d,"class","svelte-ccjhbj")},m(r,h){g(r,t,h),m(t,n),g(r,o,h),ee(s,r,h),g(r,l,h),g(r,i,h),m(i,c),g(r,u,h),g(r,a,h),g(r,p,h),g(r,d,h),m(d,f),$=!0,k||(S=x(d,"click",e[5]),k=!0)},p(e,[t]){(!$||2&t)&&E(n,e[1]);const o={};var l;!r&&1&t&&(r=!0,o.lines=e[0],l=()=>r=!1,D.push(l)),s.$set(o),(!$||4&t)&&E(c,e[2]),(!$||8&t)&&(a.value=e[3]),8&t&&N(a,"is-success",e[3]<.5),8&t&&N(a,"is-warning",e[3]>=.5&&e[3]<.8),8&t&&N(a,"is-danger",e[3]>=.8),(!$||1&t&&_!==(_=0===e[0].length))&&(d.disabled=_)},i(e){$||(Y(s.$$.fragment,e),$=!0)},o(e){Q(s.$$.fragment,e),$=!1},d(e){e&&h(t),e&&h(o),te(s,e),e&&h(l),e&&h(i),e&&h(u),e&&h(a),e&&h(p),e&&h(d),k=!1,S()}}}function Ce(e,t,n){let o;const s=j();let{prompt:r}=t,{lines:l=[]}=t;const i=Se(0,{duration:121e3});c(e,i,e=>n(3,o=e));let u,a=!1,p=function(){a||(i.set(1),confirm("Send picture?")&&(s("sendPicture",{lines:l,prompt:r}),a=!0))};return i.set(1).then(p),e.$$set=e=>{"prompt"in e&&n(1,r=e.prompt),"lines"in e&&n(0,l=e.lines)},e.$$.update=()=>{8&e.$$.dirty&&n(2,u=Math.floor(121*(1-o)))},[l,r,u,o,i,p,function(e){l=e,n(0,l)}]}class Ae extends se{constructor(e){super(),oe(this,e,Ce,Ee,i,{prompt:1,lines:0})}}function Ie(e,t,n){const o=e.slice();return o[40]=t[n],o}function Re(e,t,n){const o=e.slice();return o[35]=t[n],o}function Ne(e,t,n){const o=e.slice();return o[35]=t[n],o}function Te(e,t,n){const o=e.slice();return o[32]=t[n],o}function Ge(e,t,n){const o=e.slice();return o[13]=t[n],o}function Oe(e){let t;return{c(){t=v("h1"),t.textContent="Scores:",y(t,"class","is-title has-text-centered svelte-148bkwp")},m(e,n){g(e,t,n)},d(e){e&&h(t)}}}function je(e){let t;return{c(){t=v("h1"),t.textContent="Pick your guess for:",y(t,"class","is-title has-text-centered svelte-148bkwp")},m(e,n){g(e,t,n)},d(e){e&&h(t)}}}function Ue(e){let t;return{c(){t=v("h1"),t.textContent="Type your guess for:",y(t,"class","is-title has-text-centered svelte-148bkwp")},m(e,n){g(e,t,n)},d(e){e&&h(t)}}}function We(e){let t,n,o,s,r,l,i,c,u=e[6],a=[];for(let t=0;t<u.length;t+=1)a[t]=Me(Ie(e,u,t));const p=e=>Q(a[e],1,1,()=>{a[e]=null});return{c(){t=v("div"),n=v("div"),o=w(),s=v("div"),s.innerHTML="<strong>Score</strong>",r=w(),l=v("div"),l.innerHTML="<strong>LOLs</strong>",i=w();for(let e=0;e<a.length;e+=1)a[e].c();y(n,"class","column is-half center-text svelte-148bkwp"),y(s,"class","column is-one-quarter center-text svelte-148bkwp"),y(l,"class","column is-one-quarter center-text svelte-148bkwp"),y(t,"class","columns is-multiline half-width svelte-148bkwp")},m(e,u){g(e,t,u),m(t,n),m(t,o),m(t,s),m(t,r),m(t,l),m(t,i);for(let e=0;e<a.length;e+=1)a[e].m(t,null);c=!0},p(e,n){if(64&n[0]){let o;for(u=e[6],o=0;o<u.length;o+=1){const s=Ie(e,u,o);a[o]?(a[o].p(s,n),Y(a[o],1)):(a[o]=Me(s),a[o].c(),Y(a[o],1),a[o].m(t,null))}for(J(),o=u.length;o<a.length;o+=1)p(o);X()}},i(e){if(!c){for(let e=0;e<u.length;e+=1)Y(a[e]);c=!0}},o(e){a=a.filter(Boolean);for(let e=0;e<a.length;e+=1)Q(a[e]);c=!1},d(e){e&&h(t),_(a,e)}}}function Le(t){let n,o=t[7],s=[];for(let e=0;e<o.length;e+=1)s[e]=Be(Re(t,o,e));return{c(){for(let e=0;e<s.length;e+=1)s[e].c();n=k()},m(e,t){for(let n=0;n<s.length;n+=1)s[n].m(e,t);g(e,n,t)},p(e,t){if(132769&t[0]){let r;for(o=e[7],r=0;r<o.length;r+=1){const l=Re(e,o,r);s[r]?s[r].p(l,t):(s[r]=Be(l),s[r].c(),s[r].m(n.parentNode,n))}for(;r<s.length;r+=1)s[r].d(1);s.length=o.length}},i:e,o:e,d(e){_(s,e),e&&h(n)}}}function De(e){let t,n,o,s;const r=[Ve,ze],l=[];function i(e,t){return e[4]?0:1}return t=i(e),n=l[t]=r[t](e),{c(){n.c(),o=k()},m(e,n){l[t].m(e,n),g(e,o,n),s=!0},p(e,s){let c=t;t=i(e),t===c?l[t].p(e,s):(J(),Q(l[c],1,1,()=>{l[c]=null}),X(),n=l[t],n||(n=l[t]=r[t](e),n.c()),Y(n,1),n.m(o.parentNode,o))},i(e){s||(Y(n),s=!0)},o(e){Q(n),s=!1},d(e){l[t].d(e),e&&h(o)}}}function Pe(e){let t,n,o,s;const r=[Xe,Je],l=[];function i(e,t){return e[2]?0:1}return t=i(e),n=l[t]=r[t](e),{c(){n.c(),o=k()},m(e,n){l[t].m(e,n),g(e,o,n),s=!0},p(e,s){let c=t;t=i(e),t===c?l[t].p(e,s):(J(),Q(l[c],1,1,()=>{l[c]=null}),X(),n=l[t],n||(n=l[t]=r[t](e),n.c()),Y(n,1),n.m(o.parentNode,o))},i(e){s||(Y(n),s=!0)},o(e){Q(n),s=!1},d(e){l[t].d(e),e&&h(o)}}}function Me(e){let t,n,o,s,r,l,i,c,u,a=e[40].score+"",p=e[40].lol_score+"";return n=new de({props:{username:e[40].username}}),{c(){t=v("div"),Z(n.$$.fragment),o=w(),s=v("div"),r=b(a),l=w(),i=v("div"),c=b(p),y(t,"class","column is-half center-text svelte-148bkwp"),y(s,"class","column is-one-quarter center-text svelte-148bkwp"),y(i,"class","column is-one-quarter center-text svelte-148bkwp")},m(e,a){g(e,t,a),ee(n,t,null),g(e,o,a),g(e,s,a),m(s,r),g(e,l,a),g(e,i,a),m(i,c),u=!0},p(e,t){const o={};64&t[0]&&(o.username=e[40].username),n.$set(o),(!u||64&t[0])&&a!==(a=e[40].score+"")&&E(r,a),(!u||64&t[0])&&p!==(p=e[40].lol_score+"")&&E(c,p)},i(e){u||(Y(n.$$.fragment,e),u=!0)},o(e){Q(n.$$.fragment,e),u=!1},d(e){e&&h(t),te(n),e&&h(o),e&&h(s),e&&h(l),e&&h(i)}}}function qe(e){let t,n,o,s,r,l,i,c,u,a=e[35].prompt+"";function p(...t){return e[24](e[35],...t)}return{c(){t=v("div"),n=b(a),o=w(),s=v("div"),r=v("button"),l=b("LOL point"),y(t,"class","column is-half center-text svelte-148bkwp"),y(r,"class","button"),r.disabled=i=e[5].includes(e[35].guesser_username),y(s,"class","column is-half")},m(e,i){g(e,t,i),m(t,n),g(e,o,i),g(e,s,i),m(s,r),m(r,l),c||(u=x(r,"click",p,{once:!0}),c=!0)},p(t,o){e=t,128&o[0]&&a!==(a=e[35].prompt+"")&&E(n,a),160&o[0]&&i!==(i=e[5].includes(e[35].guesser_username))&&(r.disabled=i)},d(e){e&&h(t),e&&h(o),e&&h(s),c=!1,u()}}}function Be(e){let t,n,o=e[35].guesser_username!==e[9]&&e[35].prompt!==e[10]&&e[35].prompt!==e[0].prompt&&"-----"!==e[35].prompt&&qe(e);return{c(){t=v("div"),o&&o.c(),n=w(),y(t,"class","columns is-multiline half-width svelte-148bkwp")},m(e,s){g(e,t,s),o&&o.m(t,null),m(t,n)},p(e,s){e[35].guesser_username!==e[9]&&e[35].prompt!==e[10]&&e[35].prompt!==e[0].prompt&&"-----"!==e[35].prompt?o?o.p(e,s):(o=qe(e),o.c(),o.m(t,n)):o&&(o.d(1),o=null)},d(e){e&&h(t),o&&o.d()}}}function ze(t){let n,o,s,l,i,c=t[7],u=[];for(let e=0;e<c.length;e+=1)u[e]=He(Ne(t,c,e));return{c(){n=v("select");for(let e=0;e<u.length;e+=1)u[e].c();o=w(),s=v("button"),s.textContent="Send!",void 0===t[3]&&q(()=>t[23].call(n)),y(s,"class","button is-info is-large")},m(e,r){g(e,n,r);for(let e=0;e<u.length;e+=1)u[e].m(n,null);I(n,t[3]),g(e,o,r),g(e,s,r),l||(i=[x(n,"change",t[23]),x(s,"click",t[16])],l=!0)},p(e,t){if(640&t[0]){let o;for(c=e[7],o=0;o<c.length;o+=1){const s=Ne(e,c,o);u[o]?u[o].p(s,t):(u[o]=He(s),u[o].c(),u[o].m(n,null))}for(;o<u.length;o+=1)u[o].d(1);u.length=c.length}136&t[0]&&I(n,e[3])},i:e,o:e,d(e){e&&h(n),_(u,e),e&&h(o),e&&h(s),l=!1,r(i)}}}function Ve(e){let t,n,o,s,r=e[8],l=[];for(let t=0;t<r.length;t+=1)l[t]=Fe(Te(e,r,t));const i=e=>Q(l[e],1,1,()=>{l[e]=null});return{c(){t=v("h2"),t.textContent="Got votes:",n=w();for(let e=0;e<l.length;e+=1)l[e].c();o=k(),y(t,"class","has-text-centered")},m(e,r){g(e,t,r),g(e,n,r);for(let t=0;t<l.length;t+=1)l[t].m(e,r);g(e,o,r),s=!0},p(e,t){if(256&t[0]){let n;for(r=e[8],n=0;n<r.length;n+=1){const s=Te(e,r,n);l[n]?(l[n].p(s,t),Y(l[n],1)):(l[n]=Fe(s),l[n].c(),Y(l[n],1),l[n].m(o.parentNode,o))}for(J(),n=r.length;n<l.length;n+=1)i(n);X()}},i(e){if(!s){for(let e=0;e<r.length;e+=1)Y(l[e]);s=!0}},o(e){l=l.filter(Boolean);for(let e=0;e<l.length;e+=1)Q(l[e]);s=!1},d(e){e&&h(t),e&&h(n),_(l,e),e&&h(o)}}}function Ke(e){let t,n,o,s=e[35].prompt+"";return{c(){t=v("option"),n=b(s),t.__value=o=e[35].guesser_username,t.value=t.__value},m(e,o){g(e,t,o),m(t,n)},p(e,r){128&r[0]&&s!==(s=e[35].prompt+"")&&E(n,s),128&r[0]&&o!==(o=e[35].guesser_username)&&(t.__value=o,t.value=t.__value)},d(e){e&&h(t)}}}function He(e){let t,n=e[35].guesser_username!==e[9]&&Ke(e);return{c(){n&&n.c(),t=k()},m(e,o){n&&n.m(e,o),g(e,t,o)},p(e,o){e[35].guesser_username!==e[9]?n?n.p(e,o):(n=Ke(e),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},d(e){n&&n.d(e),e&&h(t)}}}function Fe(e){let t,n;return t=new de({props:{username:e[32].voter_username}}),{c(){Z(t.$$.fragment)},m(e,o){ee(t,e,o),n=!0},p(e,n){const o={};256&n[0]&&(o.username=e[32].voter_username),t.$set(o)},i(e){n||(Y(t.$$.fragment,e),n=!0)},o(e){Q(t.$$.fragment,e),n=!1},d(e){te(t,e)}}}function Je(t){let n,o,s,l,i,c,u,a,p,d;return{c(){n=v("div"),o=v("div"),s=v("input"),l=w(),i=v("div"),c=v("button"),u=b("Send!"),y(s,"class","input is-large"),y(s,"type","text"),y(s,"placeholder","Your guess"),s.required=!0,y(o,"class","control is-expanded"),y(c,"class","button is-info is-large"),c.disabled=a=0===t[13].length,y(i,"class","control"),y(n,"class","field has-addons has-addons-centered svelte-148bkwp")},m(e,r){g(e,n,r),m(n,o),m(o,s),C(s,t[13]),m(n,l),m(n,i),m(i,c),m(c,u),p||(d=[x(s,"input",t[22]),x(c,"click",t[15])],p=!0)},p(e,t){8192&t[0]&&s.value!==e[13]&&C(s,e[13]),8192&t[0]&&a!==(a=0===e[13].length)&&(c.disabled=a)},i:e,o:e,d(e){e&&h(n),p=!1,r(d)}}}function Xe(e){let t,n,o,s,r=e[7],l=[];for(let t=0;t<r.length;t+=1)l[t]=Ye(Ge(e,r,t));const i=e=>Q(l[e],1,1,()=>{l[e]=null});return{c(){t=v("h2"),t.textContent="Got guesses:",n=w();for(let e=0;e<l.length;e+=1)l[e].c();o=k(),y(t,"class","has-text-centered")},m(e,r){g(e,t,r),g(e,n,r);for(let t=0;t<l.length;t+=1)l[t].m(e,r);g(e,o,r),s=!0},p(e,t){if(128&t[0]){let n;for(r=e[7],n=0;n<r.length;n+=1){const s=Ge(e,r,n);l[n]?(l[n].p(s,t),Y(l[n],1)):(l[n]=Ye(s),l[n].c(),Y(l[n],1),l[n].m(o.parentNode,o))}for(J(),n=r.length;n<l.length;n+=1)i(n);X()}},i(e){if(!s){for(let e=0;e<r.length;e+=1)Y(l[e]);s=!0}},o(e){l=l.filter(Boolean);for(let e=0;e<l.length;e+=1)Q(l[e]);s=!1},d(e){e&&h(t),e&&h(n),_(l,e),e&&h(o)}}}function Ye(e){let t,n;return t=new de({props:{username:e[13].guesser_username}}),{c(){Z(t.$$.fragment)},m(e,o){ee(t,e,o),n=!0},p(e,n){const o={};128&n[0]&&(o.username=e[13].guesser_username),t.$set(o)},i(e){n||(Y(t.$$.fragment,e),n=!0)},o(e){Q(t.$$.fragment,e),n=!1},d(e){te(t,e)}}}function Qe(e){let t,n,o,s,r,l,i,c,u,a,p;function d(e,t){return e[1]===e[14].WRITE_GUESS?Ue:e[1]===e[14].PICK_GUESS?je:Oe}let f=d(e),_=f(e);n=new ke({props:{lines:e[0].lines,editable:!1}});const $=[Pe,De,Le,We],k=[];function x(e,t){return e[1]===e[14].WRITE_GUESS?0:e[1]===e[14].PICK_GUESS?1:e[1]===e[14].SCORE?2:e[1]===e[14].LEADERBOARD?3:-1}return~(s=x(e))&&(r=k[s]=$[s](e)),{c(){_.c(),t=w(),Z(n.$$.fragment),o=w(),r&&r.c(),l=w(),i=v("progress"),c=w(),u=v("h1"),a=b(e[11]),y(i,"class","progress svelte-148bkwp"),i.value=e[12],N(i,"is-success",e[12]<.5),N(i,"is-warning",e[12]>=.5&&e[12]<.8),N(i,"is-danger",e[12]>=.8),y(u,"class","has-text-centered svelte-148bkwp")},m(e,r){_.m(e,r),g(e,t,r),ee(n,e,r),g(e,o,r),~s&&k[s].m(e,r),g(e,l,r),g(e,i,r),g(e,c,r),g(e,u,r),m(u,a),p=!0},p(e,o){f!==(f=d(e))&&(_.d(1),_=f(e),_&&(_.c(),_.m(t.parentNode,t)));const c={};1&o[0]&&(c.lines=e[0].lines),n.$set(c);let u=s;s=x(e),s===u?~s&&k[s].p(e,o):(r&&(J(),Q(k[u],1,1,()=>{k[u]=null}),X()),~s?(r=k[s],r||(r=k[s]=$[s](e),r.c()),Y(r,1),r.m(l.parentNode,l)):r=null),(!p||4096&o[0])&&(i.value=e[12]),4096&o[0]&&N(i,"is-success",e[12]<.5),4096&o[0]&&N(i,"is-warning",e[12]>=.5&&e[12]<.8),4096&o[0]&&N(i,"is-danger",e[12]>=.8),(!p||2048&o[0])&&E(a,e[11])},i(e){p||(Y(n.$$.fragment,e),Y(r),p=!0)},o(e){Q(n.$$.fragment,e),Q(r),p=!1},d(e){_.d(e),e&&h(t),te(n,e),e&&h(o),~s&&k[s].d(e),e&&h(l),e&&h(i),e&&h(c),e&&h(u)}}}function Ze(e,t,n){let o,s,r,l;c(e,ce,e=>n(9,o=e)),c(e,ue,e=>n(10,s=e)),c(e,ie,e=>n(25,r=e));const i=j();let{pictures:u}=t;const a={WRITE_GUESS:"write_guess",PICK_GUESS:"pick_guess",SCORE:"scoring",LEADERBOARD:"leaderboard"};let p,d=u[0],f=a.WRITE_GUESS,m="",g=!1,h=!1,_=[],v=[],$=[],b=[];function w(){0!=u.length?(n(0,d=u.shift()),n(7,$=[{prompt:d.prompt,guesser_username:d.username}]),n(8,b=[]),n(1,f=a.WRITE_GUESS),n(2,g=d.username===o),n(13,m=""),n(5,_=[]),E.set(0,{duration:1e3}).then(()=>E.set(1)).then(()=>{g||alert("Please send a guess!")}),d.prompt===s&&(n(13,m="-----"),setTimeout(k,500))):alert("The end!")}let k=function(){i("sendGuess",m.toUpperCase()),n(2,g=!0)};let x=function(){d.username===p&&p!==o&&ie.update(e=>{let t=e.get(o);return t?(t.score+=1,e.set(o,t),console.log([...e]),e):(console.error("MISSING USER"),alert("MISSING USER!!!!"),e)}),i("sendVote",p),n(4,h=!0)},y=function(e){n(5,_=[..._,e]),i("givePoint",e)};function S(){n(1,f=a.LEADERBOARD),n(6,v=[...r.values()]),v.sort((e,t)=>100*(t.score-e.score)+t.lol_score-e.lol_score),n(6,v),E.set(.6,{duration:1e3}).then(()=>E.set(1,{duration:36e3})).then(w)}const E=Se(0,{duration:6e4});c(e,E,e=>n(12,l=e)),w();let C;return e.$$set=e=>{"pictures"in e&&n(19,u=e.pictures)},e.$$.update=()=>{4096&e.$$.dirty[0]&&n(11,C=Math.floor(60*(1-l)))},[d,f,g,p,h,_,v,$,b,o,s,C,l,m,a,k,x,y,E,u,e=>{$.push(e),$.sort((e,t)=>e.prompt.localeCompare(t.prompt)),n(7,$),$.length===r.size&&(n(1,f=a.PICK_GUESS),n(4,h=!1),o===d.username&&(n(3,p=d.username),x()),s===d.prompt&&(n(3,p=o),x()),E.set(0,{duration:1e3}).then(()=>E.set(1)).then(()=>{h||alert("Please send a vote!")}))},e=>{console.log(e),n(8,b=[...b,e]),console.log(b),b.length===r.size&&(n(1,f=a.SCORE),E.set(.4,{duration:1e3}).then(()=>E.set(1,{duration:36e3})).then(S))},function(){m=this.value,n(13,m)},function(){p=R(this),n(3,p),n(7,$)},e=>y(e.guesser_username)]}class et extends se{constructor(e){super(),oe(this,e,Ze,Qe,i,{pictures:19,onGuess:20,onVote:21},[-1,-1])}get onGuess(){return this.$$.ctx[20]}get onVote(){return this.$$.ctx[21]}}function tt(e,t,n){const o=e.slice();return o[20]=t[n],o}function nt(e,t,n){const o=e.slice();return o[17]=t[n],o}function ot(t){let n;return{c(){n=v("h1"),n.textContent="UNKNOWN STATE AAAA",y(n,"class","title has-text-centered")},m(e,t){g(e,n,t)},p:e,i:e,o:e,d(e){e&&h(n)}}}function st(e){let t,n,o={pictures:e[3]};return t=new et({props:o}),e[12](t),t.$on("sendVote",e[9]),t.$on("sendGuess",e[10]),t.$on("givePoint",e[11]),{c(){Z(t.$$.fragment)},m(e,o){ee(t,e,o),n=!0},p(e,n){const o={};8&n&&(o.pictures=e[3]),t.$set(o)},i(e){n||(Y(t.$$.fragment,e),n=!0)},o(e){Q(t.$$.fragment,e),n=!1},d(n){e[12](null),te(t,n)}}}function rt(e){let t,n,o,s,r=e[3],l=[];for(let t=0;t<r.length;t+=1)l[t]=ut(tt(e,r,t));const i=e=>Q(l[e],1,1,()=>{l[e]=null});return{c(){t=v("h1"),t.textContent="Waiting for other players to finish drawing, got:",n=w();for(let e=0;e<l.length;e+=1)l[e].c();o=k(),y(t,"class","title has-text-centered")},m(e,r){g(e,t,r),g(e,n,r);for(let t=0;t<l.length;t+=1)l[t].m(e,r);g(e,o,r),s=!0},p(e,t){if(8&t){let n;for(r=e[3],n=0;n<r.length;n+=1){const s=tt(e,r,n);l[n]?(l[n].p(s,t),Y(l[n],1)):(l[n]=ut(s),l[n].c(),Y(l[n],1),l[n].m(o.parentNode,o))}for(J(),n=r.length;n<l.length;n+=1)i(n);X()}},i(e){if(!s){for(let e=0;e<r.length;e+=1)Y(l[e]);s=!0}},o(e){l=l.filter(Boolean);for(let e=0;e<l.length;e+=1)Q(l[e]);s=!1},d(e){e&&h(t),e&&h(n),_(l,e),e&&h(o)}}}function lt(e){let t,n,o,s;return o=new Ae({props:{prompt:e[1]}}),o.$on("sendPicture",e[8]),{c(){t=v("h1"),t.textContent="Let's draw!",n=w(),Z(o.$$.fragment),y(t,"class","title has-text-centered")},m(e,r){g(e,t,r),g(e,n,r),ee(o,e,r),s=!0},p(e,t){const n={};2&t&&(n.prompt=e[1]),o.$set(n)},i(e){s||(Y(o.$$.fragment,e),s=!0)},o(e){Q(o.$$.fragment,e),s=!1},d(e){e&&h(t),e&&h(n),te(o,e)}}}function it(e){let t,n,o,s,r,l,i,c,u,a,p=e[4],d=[];for(let t=0;t<p.length;t+=1)d[t]=at(nt(e,p,t));const f=e=>Q(d[e],1,1,()=>{d[e]=null});return{c(){t=v("h1"),t.textContent="Waiting for other players",n=w(),o=v("ul");for(let e=0;e<d.length;e+=1)d[e].c();s=w(),r=v("button"),l=b("Everybody in!"),y(t,"class","title has-text-centered"),y(r,"class","button"),r.disabled=i=e[4].length<2},m(i,p){g(i,t,p),g(i,n,p),g(i,o,p);for(let e=0;e<d.length;e+=1)d[e].m(o,null);g(i,s,p),g(i,r,p),m(r,l),c=!0,u||(a=x(r,"click",e[7],{once:!0}),u=!0)},p(e,t){if(16&t){let n;for(p=e[4],n=0;n<p.length;n+=1){const s=nt(e,p,n);d[n]?(d[n].p(s,t),Y(d[n],1)):(d[n]=at(s),d[n].c(),Y(d[n],1),d[n].m(o,null))}for(J(),n=p.length;n<d.length;n+=1)f(n);X()}(!c||16&t&&i!==(i=e[4].length<2))&&(r.disabled=i)},i(e){if(!c){for(let e=0;e<p.length;e+=1)Y(d[e]);c=!0}},o(e){d=d.filter(Boolean);for(let e=0;e<d.length;e+=1)Q(d[e]);c=!1},d(e){e&&h(t),e&&h(n),e&&h(o),_(d,e),e&&h(s),e&&h(r),u=!1,a()}}}function ct(t){let n,o;return n=new ge({}),n.$on("login",t[6]),{c(){Z(n.$$.fragment)},m(e,t){ee(n,e,t),o=!0},p:e,i(e){o||(Y(n.$$.fragment,e),o=!0)},o(e){Q(n.$$.fragment,e),o=!1},d(e){te(n,e)}}}function ut(e){let t,n;return t=new de({props:{username:e[20].username}}),{c(){Z(t.$$.fragment)},m(e,o){ee(t,e,o),n=!0},p(e,n){const o={};8&n&&(o.username=e[20].username),t.$set(o)},i(e){n||(Y(t.$$.fragment,e),n=!0)},o(e){Q(t.$$.fragment,e),n=!1},d(e){te(t,e)}}}function at(e){let t,n;return t=new de({props:{username:e[17][0]}}),{c(){Z(t.$$.fragment)},m(e,o){ee(t,e,o),n=!0},p(e,n){const o={};16&n&&(o.username=e[17][0]),t.$set(o)},i(e){n||(Y(t.$$.fragment,e),n=!0)},o(e){Q(t.$$.fragment,e),n=!1},d(e){te(t,e)}}}function pt(e){let t,n,o,s,r,l,i;const c=[ct,it,lt,rt,st,ot],u=[];function a(e,t){return e[0]===e[5].LOGIN?0:e[0]===e[5].WAIT_START?1:e[0]===e[5].DRAW?2:e[0]===e[5].WAIT_DRAWERS?3:e[0]===e[5].GUESS?4:5}return n=a(e),o=u[n]=c[n](e),{c(){t=v("div"),o.c(),s=w(),r=v("iframe"),y(r,"title","music"),y(r,"id","music-iframe"),r.src!==(l="https://www.youtube.com/embed/D1RhfadVSXI")&&y(r,"src","https://www.youtube.com/embed/D1RhfadVSXI"),y(t,"class","container svelte-1br3k65")},m(e,o){g(e,t,o),u[n].m(t,null),m(t,s),m(t,r),i=!0},p(e,[r]){let l=n;n=a(e),n===l?u[n].p(e,r):(J(),Q(u[l],1,1,()=>{u[l]=null}),X(),o=u[n],o||(o=u[n]=c[n](e),o.c()),Y(o,1),o.m(t,s))},i(e){i||(Y(o),i=!0)},o(e){Q(o),i=!1},d(e){e&&h(t),u[n].d()}}}function dt(e,t,n){let o,s;c(e,ie,e=>n(15,o=e)),c(e,ce,e=>n(16,s=e));const r={LOGIN:"login",WAIT_START:"wait_start",DRAW:"draw",WAIT_DRAWERS:"wait_drawers",GUESS:"guess"};let l,i,u,a=r.LOGIN,p="",d=new he,f=[];return d.onMessage=e=>{switch(console.log(e.type),console.log(e),e.type){case"new_user":const t={username:e.username,img_src:e.img_src,proposed_prompt:e.proposed_prompt};ie.update(e=>(e.set(t.username,{lol_score:0,username:t.username,score:0,img_src:t.img_src,proposed_prompt:t.proposed_prompt}),console.log([...e]),e)),t.username===s&&(n(0,a=r.WAIT_START),console.log("Connected: ",e));break;case"old_users":const l=Object.entries(e.users).map(e=>({score:0,lol_score:0,username:e[0],img_src:e[1][0],proposed_prompt:e[1][1]}));ie.update(e=>{for(let t of l)e.set(t.username,{score:0,lol_score:0,img_src:t.img_src,username:t.username,proposed_prompt:t.proposed_prompt});return e});break;case"start_game":n(0,a=r.DRAW),n(1,p=e.assigned_prompt);break;case"picture":n(3,f=[...f,{username:e.username,lines:e.lines,prompt:e.prompt}]),f.sort(),console.log(f),f.length===o.size&&n(0,a=r.GUESS);break;case"guessed_prompt":i.onGuess(e);break;case"voted_prompt":e.voted_username!==e.voter_username&&ie.update(t=>{let n=t.get(e.voted_username);return n?(n.score+=1,t.set(e.voted_username,n),console.log([...t]),t):(console.error("MISSING USER"),alert("MISSING USER!!!!"),t)}),i.onVote(e);break;case"give_point":ie.update(t=>{let n=t.get(e.receiver_username);return n?(n.lol_score+=1,t.set(e.receiver_username,n),console.log([...t]),t):(console.error("MISSING USER"),alert("MISSING USER!!!!"),t)});break;default:alert("Unknown type, see console"),console.error(e)}},e.$$.update=()=>{32768&e.$$.dirty&&n(4,u=[...o])},[a,p,i,f,u,r,function(e){n(0,a=r.WAIT_START);let t=e.detail.username;l=e.detail.img_src;let o=e.detail.prompt;ce.set(t),ue.set(o),ie.update(e=>(e.set(t,{lol_score:0,username:t,score:0,img_src:l,proposed_prompt:o}),console.log([...e]),e)),console.log("Logged in: ",e.detail);let s=document.getElementById("telegram-login-minnybot");(null==s?void 0:s.parentNode)&&s.parentNode.removeChild(s),d.setUp(t,l,o)},function(){null==d||d.sendObject({type:"start_game",assigned_prompt:""})},function(e){console.log("sendPicture message",e),n(0,a=r.WAIT_DRAWERS),null==d||d.sendObject({type:"picture",lines:e.detail.lines,prompt:e.detail.prompt,username:s})},function(e){console.log("sendVote message",e),null==d||d.sendObject({type:"voted_prompt",voted_username:e.detail,voter_username:s})},function(e){console.log("sendGuess message",e),null==d||d.sendObject({type:"guessed_prompt",prompt:e.detail,guesser_username:s})},function(e){console.log("givePoint message",e),null==d||d.sendObject({type:"give_point",receiver_username:e.detail})},function(e){W[e?"unshift":"push"](()=>{i=e,n(2,i)})}]}return new class extends se{constructor(e){super(),oe(this,e,dt,pt,i,{})}}({target:document.body,props:{}})}();
//# sourceMappingURL=bundle.js.map
