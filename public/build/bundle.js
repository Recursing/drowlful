var app=function(){"use strict";function e(){}const t=e=>e;function n(e,t){for(const n in t)e[n]=t[n];return e}function o(e){return e()}function r(){return Object.create(null)}function s(e){e.forEach(o)}function l(e){return"function"==typeof e}function i(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function c(t,n,o){t.$$.on_destroy.push(function(t,...n){if(null==t)return e;const o=t.subscribe(...n);return o.unsubscribe?()=>o.unsubscribe():o}(n,o))}const u="undefined"!=typeof window;let a=u?()=>window.performance.now():()=>Date.now(),p=u?e=>requestAnimationFrame(e):e;const d=new Set;function m(e){d.forEach(t=>{t.c(e)||(d.delete(t),t.f())}),0!==d.size&&p(m)}function f(e,t){e.appendChild(t)}function g(e,t,n){e.insertBefore(t,n||null)}function h(e){e.parentNode.removeChild(e)}function _(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function v(e){return document.createElement(e)}function w(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function $(e){return document.createTextNode(e)}function k(){return $(" ")}function b(){return $("")}function x(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function y(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function C(e){return""===e?null:+e}function S(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function E(e,t){e.value=null==t?"":t}function A(e,t,n,o){e.style.setProperty(t,n,o?"important":"")}function P(e,t){for(let n=0;n<e.options.length;n+=1){const o=e.options[n];if(o.__value===t)return void(o.selected=!0)}}function I(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}function j(e,t,n){e.classList[n?"add":"remove"](t)}let O;function N(e){O=e}function U(){if(!O)throw new Error("Function called outside component initialization");return O}function R(){const e=U();return(t,n)=>{const o=e.$$.callbacks[t];if(o){const r=function(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}(t,n);o.slice().forEach(t=>{t.call(e,r)})}}}const G=[],M=[],T=[],L=[],D=Promise.resolve();let W=!1;function B(e){T.push(e)}let q=!1;const z=new Set;function K(){if(!q){q=!0;do{for(let e=0;e<G.length;e+=1){const t=G[e];N(t),V(t.$$)}for(N(null),G.length=0;M.length;)M.pop()();for(let e=0;e<T.length;e+=1){const t=T[e];z.has(t)||(z.add(t),t())}T.length=0}while(G.length);for(;L.length;)L.pop()();W=!1,q=!1,z.clear()}}function V(e){if(null!==e.fragment){e.update(),s(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(B)}}const H=new Set;let J;function X(){J={r:0,c:[],p:J}}function Y(){J.r||s(J.c),J=J.p}function F(e,t){e&&e.i&&(H.delete(e),e.i(t))}function Q(e,t,n,o){if(e&&e.o){if(H.has(e))return;H.add(e),J.c.push(()=>{H.delete(e),o&&(n&&e.d(1),o())}),e.o(t)}}function Z(e){e&&e.c()}function ee(e,t,n){const{fragment:r,on_mount:i,on_destroy:c,after_update:u}=e.$$;r&&r.m(t,n),B(()=>{const t=i.map(o).filter(l);c?c.push(...t):s(t),e.$$.on_mount=[]}),u.forEach(B)}function te(e,t){const n=e.$$;null!==n.fragment&&(s(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function ne(e,t){-1===e.$$.dirty[0]&&(G.push(e),W||(W=!0,D.then(K)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function oe(t,n,o,l,i,c,u=[-1]){const a=O;N(t);const p=n.props||{},d=t.$$={fragment:null,ctx:null,props:c,update:e,not_equal:i,bound:r(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(a?a.$$.context:[]),callbacks:r(),dirty:u,skip_bound:!1};let m=!1;if(d.ctx=o?o(t,p,(e,n,...o)=>{const r=o.length?o[0]:n;return d.ctx&&i(d.ctx[e],d.ctx[e]=r)&&(!d.skip_bound&&d.bound[e]&&d.bound[e](r),m&&ne(t,e)),n}):[],d.update(),m=!0,s(d.before_update),d.fragment=!!l&&l(d.ctx),n.target){if(n.hydrate){const e=function(e){return Array.from(e.childNodes)}(n.target);d.fragment&&d.fragment.l(e),e.forEach(h)}else d.fragment&&d.fragment.c();n.intro&&F(t.$$.fragment),ee(t,n.target,n.anchor),K()}N(a)}class re{$destroy(){te(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const se=[];function le(t,n=e){let o;const r=[];function s(e){if(i(t,e)&&(t=e,o)){const e=!se.length;for(let e=0;e<r.length;e+=1){const n=r[e];n[1](),se.push(n,t)}if(e){for(let e=0;e<se.length;e+=2)se[e][0](se[e+1]);se.length=0}}}return{set:s,update:function(e){s(e(t))},subscribe:function(l,i=e){const c=[l,i];return r.push(c),1===r.length&&(o=n(s)||e),l(t),()=>{const e=r.indexOf(c);-1!==e&&r.splice(e,1),0===r.length&&(o(),o=null)}}}}const ie=le(new Map),ce=le(""),ue=le(""),ae=le("login");function pe(t){let n,o,r,s,l,i;return{c(){n=v("div"),o=v("img"),s=k(),l=v("p"),i=$(t[0]),y(o,"alt","user pic"),o.src!==(r=t[1])&&y(o,"src",r),y(l,"class","has-text-centered svelte-1a9drn7"),y(n,"class","card svelte-1a9drn7")},m(e,t){g(e,n,t),f(n,o),f(n,s),f(n,l),f(l,i)},p(e,[t]){2&t&&o.src!==(r=e[1])&&y(o,"src",r),1&t&&S(i,e[0])},i:e,o:e,d(e){e&&h(n)}}}function de(e,t,n){let o;var r;c(e,ie,e=>n(3,o=e));let s,{username:l}=t;return e.$$set=e=>{"username"in e&&n(0,l=e.username)},e.$$.update=()=>{13&e.$$.dirty&&n(1,s=null===n(2,r=o.get(l))||void 0===r?void 0:r.img_src)},[l,s]}class me extends re{constructor(e){super(),oe(this,e,de,pe,i,{username:0})}}function fe(t){let n,o,r,l,i,c,u,a,p,d,m,_,w,$,b,C,S,A,P,I,j,O;return{c(){n=v("div"),o=v("div"),r=v("div"),l=v("label"),l.textContent="Username",i=k(),c=v("input"),u=k(),a=v("div"),p=v("div"),d=v("label"),d.textContent="Image url",m=k(),_=v("input"),w=k(),$=v("div"),b=v("div"),C=v("div"),S=v("input"),A=k(),P=v("div"),I=v("button"),I.textContent="Login",y(l,"for","paperInputs2"),y(c,"id","username-input"),y(c,"class","input-block"),y(c,"type","text"),y(c,"placeholder","Username"),c.required=!0,y(r,"class","form-group"),y(o,"class","col sm-4"),y(d,"for","paperInputs3"),y(_,"id","image-url-input"),y(_,"class","input-block"),y(_,"type","url"),_.required=!0,y(p,"class","form-group"),y(a,"class","col sm-8"),y(n,"class","row"),y(S,"class","input-block"),y(S,"type","text"),y(S,"placeholder","Your prompt"),S.required=!0,y(C,"class","form-group"),y(b,"class","col sm-10"),y(I,"id","login-button"),y(I,"class","button is-link svelte-1ppidry"),y(P,"class","col"),y($,"class","row")},m(e,s){g(e,n,s),f(n,o),f(o,r),f(r,l),f(r,i),f(r,c),E(c,t[0]),f(n,u),f(n,a),f(a,p),f(p,d),f(p,m),f(p,_),E(_,t[2]),g(e,w,s),g(e,$,s),f($,b),f(b,C),f(C,S),E(S,t[1]),f($,A),f($,P),f(P,I),j||(O=[x(c,"input",t[4]),x(_,"input",t[5]),x(S,"input",t[6]),x(I,"click",t[3])],j=!0)},p(e,[t]){1&t&&c.value!==e[0]&&E(c,e[0]),4&t&&E(_,e[2]),2&t&&S.value!==e[1]&&E(S,e[1])},i:e,o:e,d(e){e&&h(n),e&&h(w),e&&h($),j=!1,s(O)}}}function ge(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,s){function l(e){try{c(o.next(e))}catch(e){s(e)}}function i(e){try{c(o.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(l,i)}c((o=o.apply(e,t||[])).next())}))};const r=R();let s="",l="";const i=["https://upload.wikimedia.org/wikipedia/en/a/a6/Pok%C3%A9mon_Pikachu_art.png","https://upload.wikimedia.org/wikipedia/en/2/28/Pok%C3%A9mon_Bulbasaur_art.png","https://upload.wikimedia.org/wikipedia/en/5/59/Pok%C3%A9mon_Squirtle_art.png","https://upload.wikimedia.org/wikipedia/en/a/a5/Pok%C3%A9mon_Charmander_art.png","https://upload.wikimedia.org/wikipedia/en/2/20/Pok%C3%A9mon_Venusaur_art.png","https://annachromy.com/wp-content/uploads/2020/08/Sisifo-pisa.jpg","https://upload.wikimedia.org/wikipedia/en/2/22/Pok%C3%A9mon_Jigglypuff_art.png","https://upload.wikimedia.org/wikipedia/en/a/aa/Pok%C3%A9mon_Meowth_art.png","https://upload.wikimedia.org/wikipedia/en/2/2d/Pok%C3%A9mon_Psyduck_art.png","https://upload.wikimedia.org/wikipedia/en/e/ea/Pok%C3%A9mon_Abra%2C_Kadabra%2C_Alakazam_art.png","https://upload.wikimedia.org/wikipedia/en/4/4c/Pok%C3%A9mon_Haunter_art.png","https://upload.wikimedia.org/wikipedia/en/b/bf/Pok%C3%A9mon_Gengar_art.png","https://upload.wikimedia.org/wikipedia/en/3/3f/Pok%C3%A9mon_Koffing_and_Weezing_art.png","https://upload.wikimedia.org/wikipedia/en/3/3f/Pok%C3%A9mon_Magikarp_art.png","https://upload.wikimedia.org/wikipedia/en/a/a9/Pok%C3%A9mon_Eevee_art.png","https://upload.wikimedia.org/wikipedia/en/4/40/Pok%C3%A9mon_Lapras_art.png","https://upload.wikimedia.org/wikipedia/en/3/3f/Pok%C3%A9mon_Snorlax_art.png","https://upload.wikimedia.org/wikipedia/en/1/1a/Pok%C3%A9mon_Chikorita_art.png","https://upload.wikimedia.org/wikipedia/en/a/aa/Pichu_artwork.png","https://upload.wikimedia.org/wikipedia/en/5/53/Pok%C3%A9mon_Togepi_art.png","https://upload.wikimedia.org/wikipedia/en/2/22/Pok%C3%A9mon_Mudkip_art.png"];let c=i[Math.floor(Math.random()*i.length)];function u(e){n(0,s=e.username||e.first_name+" "+e.last_name),console.log(JSON.stringify(e,null,2)),n(2,c=e.photo_url||c),console.log("Image src: "+c),a()}function a(){l?(console.log("dispatching"),r("login",{username:s,img_src:c,prompt:l})):alert("Write prompt first!")}var p;return p=()=>o(void 0,void 0,void 0,(function*(){window.onTelegramAuth=u})),U().$$.on_mount.push(p),[s,l,c,a,function(){s=this.value,n(0,s)},function(){c=this.value,n(2,c)},function(){l=this.value,n(1,l)}]}class he extends re{constructor(e){super(),oe(this,e,ge,fe,i,{})}}const _e=new class{constructor(){this.onMessage=e=>{},this.websocket=null}setUp(e,t,n){const o=`wss://${document.location.host}:8000/ws/${e}?prompt=${n}&img=${encodeURIComponent(t)}`;console.log(o),this.websocket=new WebSocket(o),this.websocket.onmessage=e=>{console.log(e),console.log("got data:",e.data),this.onMessage(JSON.parse(e.data))}}sendObject(e){null!==this.websocket?this.websocket.send(JSON.stringify(e)):alert("Can't send without websocket!")}};function ve(e,t,n){const o=e.slice();return o[11]=t[n].stroke,o[12]=t[n].width,o[13]=t[n].points,o}function we(e){let t,n;return{c(){t=w("polyline"),A(t,"fill","none"),A(t,"stroke",e[11]),A(t,"stroke-width",e[12]),y(t,"points",n=e[13]),y(t,"stroke-linecap","round"),y(t,"stroke-linejoin","round"),y(t,"class","svelte-1w3pg28")},m(e,n){g(e,t,n)},p(e,o){1&o&&A(t,"stroke",e[11]),1&o&&A(t,"stroke-width",e[12]),1&o&&n!==(n=e[13])&&y(t,"points",n)},d(e){e&&h(t)}}}function $e(e){let t,n,o,r,l,i,c,u,a,p,d,m,_,w,b,S,A,I,j,O,N,U,R,G,M,T;return{c(){t=v("div"),n=v("label"),o=$("Width:\n      "),r=v("input"),l=k(),i=v("input"),c=k(),u=v("label"),a=$("Color:\n      "),p=v("select"),d=v("option"),d.textContent="red",m=v("option"),m.textContent="orange",_=v("option"),_.textContent="yellow",w=v("option"),w.textContent="green",b=v("option"),b.textContent="cyan",S=v("option"),S.textContent="blue",A=v("option"),A.textContent="purple",I=v("option"),I.textContent="pink",j=v("option"),j.textContent="white",O=v("option"),O.textContent="black",N=v("option"),N.textContent="gray",U=v("option"),U.textContent="brown",R=k(),G=v("button"),G.textContent="undo",y(r,"type","number"),y(r,"min","1"),y(r,"max","30"),y(i,"type","range"),y(i,"min","1"),y(i,"max","30"),y(n,"class","svelte-1w3pg28"),d.__value="red",d.value=d.__value,m.__value="orange",m.value=m.__value,_.__value="yellow",_.value=_.__value,w.__value="green",w.value=w.__value,b.__value="cyan",b.value=b.__value,S.__value="blue",S.value=S.__value,A.__value="purple",A.value=A.__value,I.__value="pink",I.value=I.__value,j.__value="white",j.value=j.__value,O.__value="black",O.value=O.__value,N.__value="gray",N.value=N.__value,U.__value="brown",U.value=U.__value,void 0===e[2].stroke&&B(()=>e[8].call(p)),y(u,"class","svelte-1w3pg28"),y(G,"class","svelte-1w3pg28"),y(t,"class","controls centered-flex svelte-1w3pg28")},m(s,h){g(s,t,h),f(t,n),f(n,o),f(n,r),E(r,e[2].width),f(n,l),f(n,i),E(i,e[2].width),f(t,c),f(t,u),f(u,a),f(u,p),f(p,d),f(p,m),f(p,_),f(p,w),f(p,b),f(p,S),f(p,A),f(p,I),f(p,j),f(p,O),f(p,N),f(p,U),P(p,e[2].stroke),f(t,R),f(t,G),M||(T=[x(r,"input",e[6]),x(i,"change",e[7]),x(i,"input",e[7]),x(p,"change",e[8]),x(G,"click",e[9])],M=!0)},p(e,t){4&t&&C(r.value)!==e[2].width&&E(r,e[2].width),4&t&&E(i,e[2].width),4&t&&P(p,e[2].stroke)},d(e){e&&h(t),M=!1,s(T)}}}function ke(t){let n,o,r,l,i,c,u,a=t[0],p=[];for(let e=0;e<a.length;e+=1)p[e]=we(ve(t,a,e));let d=t[1]&&$e(t);return{c(){n=w("svg");for(let e=0;e<p.length;e+=1)p[e].c();o=w("polyline"),l=k(),d&&d.c(),i=b(),A(o,"fill","none"),A(o,"stroke",t[2].stroke),A(o,"stroke-width",t[2].width),y(o,"points",r=t[2].points),y(o,"stroke-linecap","round"),y(o,"stroke-linejoin","round"),y(o,"class","svelte-1w3pg28"),y(n,"width","800"),y(n,"height","600"),y(n,"class","svelte-1w3pg28")},m(e,r){g(e,n,r);for(let e=0;e<p.length;e+=1)p[e].m(n,null);f(n,o),g(e,l,r),d&&d.m(e,r),g(e,i,r),c||(u=[x(n,"mousemove",t[5]),x(n,"mouseup",t[3]),x(n,"mousedown",t[4]),x(n,"mouseleave",t[3])],c=!0)},p(e,[t]){if(1&t){let r;for(a=e[0],r=0;r<a.length;r+=1){const s=ve(e,a,r);p[r]?p[r].p(s,t):(p[r]=we(s),p[r].c(),p[r].m(n,o))}for(;r<p.length;r+=1)p[r].d(1);p.length=a.length}4&t&&A(o,"stroke",e[2].stroke),4&t&&A(o,"stroke-width",e[2].width),4&t&&r!==(r=e[2].points)&&y(o,"points",r),e[1]?d?d.p(e,t):(d=$e(e),d.c(),d.m(i.parentNode,i)):d&&(d.d(1),d=null)},i:e,o:e,d(e){e&&h(n),_(p,e),e&&h(l),d&&d.d(e),e&&h(i),c=!1,s(u)}}}function be(e,t,n){let{lines:o=[]}=t,{editable:r=!0}=t,s={stroke:"red",width:2,points:""},l=!1;return e.$$set=e=>{"lines"in e&&n(0,o=e.lines),"editable"in e&&n(1,r=e.editable)},[o,r,s,function(){l&&(l=!1,s.points.split(" ").length<2||(o.push({stroke:s.stroke,width:s.width,points:s.points}),n(0,o),n(2,s.points="",s)))},function(){r&&(l=!0)},function(e){l&&n(2,s.points+=" "+e.offsetX+","+e.offsetY,s)},function(){s.width=C(this.value),n(2,s)},function(){s.width=C(this.value),n(2,s)},function(){s.stroke=I(this),n(2,s)},()=>{o.length>0&&n(0,o=o.slice(0,o.length-1))}]}class xe extends re{constructor(e){super(),oe(this,e,be,ke,i,{lines:0,editable:1})}}function ye(e){return"[object Date]"===Object.prototype.toString.call(e)}function Ce(e,t){if(e===t||e!=e)return()=>e;const n=typeof e;if(n!==typeof t||Array.isArray(e)!==Array.isArray(t))throw new Error("Cannot interpolate values of different type");if(Array.isArray(e)){const n=t.map((t,n)=>Ce(e[n],t));return e=>n.map(t=>t(e))}if("object"===n){if(!e||!t)throw new Error("Object cannot be null");if(ye(e)&&ye(t)){e=e.getTime();const n=(t=t.getTime())-e;return t=>new Date(e+t*n)}const n=Object.keys(t),o={};return n.forEach(n=>{o[n]=Ce(e[n],t[n])}),e=>{const t={};return n.forEach(n=>{t[n]=o[n](e)}),t}}if("number"===n){const n=t-e;return t=>e+t*n}throw new Error(`Cannot interpolate ${n} values`)}function Se(e,o={}){const r=le(e);let s,l=e;function i(i,c){if(null==e)return r.set(e=i),Promise.resolve();l=i;let u=s,f=!1,{delay:g=0,duration:h=400,easing:_=t,interpolate:v=Ce}=n(n({},o),c);if(0===h)return u&&(u.abort(),u=null),r.set(e=l),Promise.resolve();const w=a()+g;let $;return s=function(e){let t;return 0===d.size&&p(m),{promise:new Promise(n=>{d.add(t={c:e,f:n})}),abort(){d.delete(t)}}}(t=>{if(t<w)return!0;f||($=v(e,i),"function"==typeof h&&(h=h(e,i)),f=!0),u&&(u.abort(),u=null);const n=t-w;return n>h?(r.set(e=i),!1):(r.set(e=$(_(n/h))),!0)}),s.promise}return{set:i,update:(t,n)=>i(t(l,e),n),subscribe:r.subscribe}}function Ee(e){let t,n,o,r,s,l,i,c,u,a,p,d,m,_,w,b,C;function E(t){e[6].call(null,t)}let A={};return void 0!==e[0]&&(A.lines=e[0]),r=new xe({props:A}),M.push(()=>function(e,t,n){const o=e.$$.props[t];void 0!==o&&(e.$$.bound[o]=n,n(e.$$.ctx[o]))}(r,"lines",E)),{c(){t=v("h1"),n=$(e[1]),o=k(),Z(r.$$.fragment),l=k(),i=v("h1"),c=$(e[2]),u=k(),a=v("progress"),p=k(),d=v("button"),m=$("Done!"),y(t,"class","has-text-centered svelte-ccjhbj"),y(i,"class","has-text-centered svelte-ccjhbj"),y(a,"class","progress margin-bottom svelte-ccjhbj"),a.value=e[3],j(a,"is-success",e[3]<.5),j(a,"is-warning",e[3]>=.5&&e[3]<.8),j(a,"is-danger",e[3]>=.8),d.disabled=_=0===e[0].length,y(d,"class","svelte-ccjhbj")},m(s,h){g(s,t,h),f(t,n),g(s,o,h),ee(r,s,h),g(s,l,h),g(s,i,h),f(i,c),g(s,u,h),g(s,a,h),g(s,p,h),g(s,d,h),f(d,m),w=!0,b||(C=x(d,"click",e[5]),b=!0)},p(e,[t]){(!w||2&t)&&S(n,e[1]);const o={};var l;!s&&1&t&&(s=!0,o.lines=e[0],l=()=>s=!1,L.push(l)),r.$set(o),(!w||4&t)&&S(c,e[2]),(!w||8&t)&&(a.value=e[3]),8&t&&j(a,"is-success",e[3]<.5),8&t&&j(a,"is-warning",e[3]>=.5&&e[3]<.8),8&t&&j(a,"is-danger",e[3]>=.8),(!w||1&t&&_!==(_=0===e[0].length))&&(d.disabled=_)},i(e){w||(F(r.$$.fragment,e),w=!0)},o(e){Q(r.$$.fragment,e),w=!1},d(e){e&&h(t),e&&h(o),te(r,e),e&&h(l),e&&h(i),e&&h(u),e&&h(a),e&&h(p),e&&h(d),b=!1,C()}}}function Ae(e,t,n){let o,r;c(e,ce,e=>n(8,r=e));let{prompt:s}=t,{lines:l=[]}=t;const i=Se(0,{duration:121e3});c(e,i,e=>n(3,o=e));let u,a=!1,p=function(){a||(i.set(1),confirm("Send picture?")&&(console.log("sendPicture:",l,s),_e.sendObject({type:"picture",lines:l,prompt:s,username:r}),a=!0,ae.set("wait_drawers")))};return i.set(1).then(p),e.$$set=e=>{"prompt"in e&&n(1,s=e.prompt),"lines"in e&&n(0,l=e.lines)},e.$$.update=()=>{8&e.$$.dirty&&n(2,u=Math.floor(121*(1-o)))},[l,s,u,o,i,p,function(e){l=e,n(0,l)}]}class Pe extends re{constructor(e){super(),oe(this,e,Ae,Ee,i,{prompt:1,lines:0})}}function Ie(e,t,n){const o=e.slice();return o[39]=t[n],o}function je(e,t,n){const o=e.slice();return o[34]=t[n],o}function Oe(e,t,n){const o=e.slice();return o[34]=t[n],o}function Ne(e,t,n){const o=e.slice();return o[31]=t[n],o}function Ue(e,t,n){const o=e.slice();return o[13]=t[n],o}function Re(e){let t;return{c(){t=v("h1"),t.textContent="Scores:",y(t,"class","has-text-centered svelte-x46n78")},m(e,n){g(e,t,n)},d(e){e&&h(t)}}}function Ge(e){let t;return{c(){t=v("h1"),t.textContent="Pick your guess for:",y(t,"class","has-text-centered svelte-x46n78")},m(e,n){g(e,t,n)},d(e){e&&h(t)}}}function Me(e){let t;return{c(){t=v("h1"),t.textContent="Type your guess for:",y(t,"class","has-text-centered svelte-x46n78")},m(e,n){g(e,t,n)},d(e){e&&h(t)}}}function Te(e){let t,n,o,r,s,l,i,c,u,a,p,d=e[0].prompt+"",m=e[6],w=[];for(let t=0;t<m.length;t+=1)w[t]=Be(Ie(e,m,t));const b=e=>Q(w[e],1,1,()=>{w[e]=null});return{c(){t=v("h1"),n=$(d),o=k(),r=v("div"),s=v("div"),s.innerHTML="<strong>User</strong>",l=k(),i=v("div"),i.innerHTML="<strong>Score</strong>",c=k(),u=v("div"),u.innerHTML="<strong>LOLs</strong>",a=k();for(let e=0;e<w.length;e+=1)w[e].c();y(t,"class","has-text-centered svelte-x46n78"),y(s,"class","col sm-6 center-text svelte-x46n78"),y(i,"class","col sm-3 center-text svelte-x46n78"),y(u,"class","col sm-3 center-text svelte-x46n78"),y(r,"class","row svelte-x46n78")},m(e,d){g(e,t,d),f(t,n),g(e,o,d),g(e,r,d),f(r,s),f(r,l),f(r,i),f(r,c),f(r,u),f(r,a);for(let e=0;e<w.length;e+=1)w[e].m(r,null);p=!0},p(e,t){if((!p||1&t[0])&&d!==(d=e[0].prompt+"")&&S(n,d),64&t[0]){let n;for(m=e[6],n=0;n<m.length;n+=1){const o=Ie(e,m,n);w[n]?(w[n].p(o,t),F(w[n],1)):(w[n]=Be(o),w[n].c(),F(w[n],1),w[n].m(r,null))}for(X(),n=m.length;n<w.length;n+=1)b(n);Y()}},i(e){if(!p){for(let e=0;e<m.length;e+=1)F(w[e]);p=!0}},o(e){w=w.filter(Boolean);for(let e=0;e<w.length;e+=1)Q(w[e]);p=!1},d(e){e&&h(t),e&&h(o),e&&h(r),_(w,e)}}}function Le(t){let n,o=t[7],r=[];for(let e=0;e<o.length;e+=1)r[e]=ze(je(t,o,e));return{c(){for(let e=0;e<r.length;e+=1)r[e].c();n=b()},m(e,t){for(let n=0;n<r.length;n+=1)r[n].m(e,t);g(e,n,t)},p(e,t){if(132769&t[0]){let s;for(o=e[7],s=0;s<o.length;s+=1){const l=je(e,o,s);r[s]?r[s].p(l,t):(r[s]=ze(l),r[s].c(),r[s].m(n.parentNode,n))}for(;s<r.length;s+=1)r[s].d(1);r.length=o.length}},i:e,o:e,d(e){_(r,e),e&&h(n)}}}function De(e){let t,n,o,r;const s=[Ve,Ke],l=[];function i(e,t){return e[4]?0:1}return t=i(e),n=l[t]=s[t](e),{c(){n.c(),o=b()},m(e,n){l[t].m(e,n),g(e,o,n),r=!0},p(e,r){let c=t;t=i(e),t===c?l[t].p(e,r):(X(),Q(l[c],1,1,()=>{l[c]=null}),Y(),n=l[t],n||(n=l[t]=s[t](e),n.c()),F(n,1),n.m(o.parentNode,o))},i(e){r||(F(n),r=!0)},o(e){Q(n),r=!1},d(e){l[t].d(e),e&&h(o)}}}function We(e){let t,n,o,r;const s=[Fe,Ye],l=[];function i(e,t){return e[2]?0:1}return t=i(e),n=l[t]=s[t](e),{c(){n.c(),o=b()},m(e,n){l[t].m(e,n),g(e,o,n),r=!0},p(e,r){let c=t;t=i(e),t===c?l[t].p(e,r):(X(),Q(l[c],1,1,()=>{l[c]=null}),Y(),n=l[t],n||(n=l[t]=s[t](e),n.c()),F(n,1),n.m(o.parentNode,o))},i(e){r||(F(n),r=!0)},o(e){Q(n),r=!1},d(e){l[t].d(e),e&&h(o)}}}function Be(e){let t,n,o,r,s,l,i,c,u,a,p=e[39].score+"",d=e[39].lol_score+"";return o=new me({props:{username:e[39].username}}),{c(){t=v("div"),n=v("div"),Z(o.$$.fragment),r=k(),s=v("div"),l=$(p),i=k(),c=v("div"),u=$(d),y(n,"class","centered-flex"),y(t,"class","col sm-6"),y(s,"class","col sm-3 center-text svelte-x46n78"),y(c,"class","col sm-3 center-text svelte-x46n78")},m(e,p){g(e,t,p),f(t,n),ee(o,n,null),g(e,r,p),g(e,s,p),f(s,l),g(e,i,p),g(e,c,p),f(c,u),a=!0},p(e,t){const n={};64&t[0]&&(n.username=e[39].username),o.$set(n),(!a||64&t[0])&&p!==(p=e[39].score+"")&&S(l,p),(!a||64&t[0])&&d!==(d=e[39].lol_score+"")&&S(u,d)},i(e){a||(F(o.$$.fragment,e),a=!0)},o(e){Q(o.$$.fragment,e),a=!1},d(e){e&&h(t),te(o),e&&h(r),e&&h(s),e&&h(i),e&&h(c)}}}function qe(e){let t,n,o,r,s,l,i,c,u,a=e[34].prompt+"";function p(...t){return e[24](e[34],...t)}return{c(){t=v("div"),n=$(a),o=k(),r=v("div"),s=v("button"),l=$("LOL point"),y(t,"class","col sm-6 center-text svelte-x46n78"),y(s,"class","button"),s.disabled=i=e[5].includes(e[34].guesser_username),y(r,"class","col sm-6 center-text svelte-x46n78")},m(e,i){g(e,t,i),f(t,n),g(e,o,i),g(e,r,i),f(r,s),f(s,l),c||(u=x(s,"click",p,{once:!0}),c=!0)},p(t,o){e=t,128&o[0]&&a!==(a=e[34].prompt+"")&&S(n,a),160&o[0]&&i!==(i=e[5].includes(e[34].guesser_username))&&(s.disabled=i)},d(e){e&&h(t),e&&h(o),e&&h(r),c=!1,u()}}}function ze(e){let t,n,o=e[34].guesser_username!==e[9]&&e[34].prompt!==e[10]&&e[34].prompt!==e[0].prompt&&"-----"!==e[34].prompt&&qe(e);return{c(){t=v("div"),o&&o.c(),n=k(),y(t,"class","row svelte-x46n78")},m(e,r){g(e,t,r),o&&o.m(t,null),f(t,n)},p(e,r){e[34].guesser_username!==e[9]&&e[34].prompt!==e[10]&&e[34].prompt!==e[0].prompt&&"-----"!==e[34].prompt?o?o.p(e,r):(o=qe(e),o.c(),o.m(t,n)):o&&(o.d(1),o=null)},d(e){e&&h(t),o&&o.d()}}}function Ke(t){let n,o,r,l,i,c,u,a,p,d=t[7],m=[];for(let e=0;e<d.length;e+=1)m[e]=Je(Oe(t,d,e));return{c(){n=v("div"),o=v("div"),r=v("div"),l=v("select");for(let e=0;e<m.length;e+=1)m[e].c();i=k(),c=v("div"),u=v("button"),u.textContent="Send!",y(l,"class","input-block"),void 0===t[3]&&B(()=>t[23].call(l)),y(r,"class","form-group"),y(o,"class","col sm-10"),y(u,"class","button"),y(c,"class","col sm-2"),y(n,"class","row svelte-x46n78")},m(e,s){g(e,n,s),f(n,o),f(o,r),f(r,l);for(let e=0;e<m.length;e+=1)m[e].m(l,null);P(l,t[3]),f(n,i),f(n,c),f(c,u),a||(p=[x(l,"change",t[23]),x(u,"click",t[16])],a=!0)},p(e,t){if(640&t[0]){let n;for(d=e[7],n=0;n<d.length;n+=1){const o=Oe(e,d,n);m[n]?m[n].p(o,t):(m[n]=Je(o),m[n].c(),m[n].m(l,null))}for(;n<m.length;n+=1)m[n].d(1);m.length=d.length}136&t[0]&&P(l,e[3])},i:e,o:e,d(e){e&&h(n),_(m,e),a=!1,s(p)}}}function Ve(e){let t,n,o,r,s=e[8],l=[];for(let t=0;t<s.length;t+=1)l[t]=Xe(Ne(e,s,t));const i=e=>Q(l[e],1,1,()=>{l[e]=null});return{c(){t=v("h2"),t.textContent="Got votes:",n=k(),o=v("div");for(let e=0;e<l.length;e+=1)l[e].c();y(t,"class","has-text-centered"),y(o,"class","centered-flex")},m(e,s){g(e,t,s),g(e,n,s),g(e,o,s);for(let e=0;e<l.length;e+=1)l[e].m(o,null);r=!0},p(e,t){if(256&t[0]){let n;for(s=e[8],n=0;n<s.length;n+=1){const r=Ne(e,s,n);l[n]?(l[n].p(r,t),F(l[n],1)):(l[n]=Xe(r),l[n].c(),F(l[n],1),l[n].m(o,null))}for(X(),n=s.length;n<l.length;n+=1)i(n);Y()}},i(e){if(!r){for(let e=0;e<s.length;e+=1)F(l[e]);r=!0}},o(e){l=l.filter(Boolean);for(let e=0;e<l.length;e+=1)Q(l[e]);r=!1},d(e){e&&h(t),e&&h(n),e&&h(o),_(l,e)}}}function He(e){let t,n,o,r=e[34].prompt+"";return{c(){t=v("option"),n=$(r),t.__value=o=e[34].guesser_username,t.value=t.__value},m(e,o){g(e,t,o),f(t,n)},p(e,s){128&s[0]&&r!==(r=e[34].prompt+"")&&S(n,r),128&s[0]&&o!==(o=e[34].guesser_username)&&(t.__value=o,t.value=t.__value)},d(e){e&&h(t)}}}function Je(e){let t,n=e[34].guesser_username!==e[9]&&He(e);return{c(){n&&n.c(),t=b()},m(e,o){n&&n.m(e,o),g(e,t,o)},p(e,o){e[34].guesser_username!==e[9]?n?n.p(e,o):(n=He(e),n.c(),n.m(t.parentNode,t)):n&&(n.d(1),n=null)},d(e){n&&n.d(e),e&&h(t)}}}function Xe(e){let t,n;return t=new me({props:{username:e[31].voter_username}}),{c(){Z(t.$$.fragment)},m(e,o){ee(t,e,o),n=!0},p(e,n){const o={};256&n[0]&&(o.username=e[31].voter_username),t.$set(o)},i(e){n||(F(t.$$.fragment,e),n=!0)},o(e){Q(t.$$.fragment,e),n=!1},d(e){te(t,e)}}}function Ye(t){let n,o,r,l,i,c,u,a,p,d,m;return{c(){n=v("div"),o=v("div"),r=v("div"),l=v("input"),i=k(),c=v("div"),u=v("button"),a=$("Send!"),y(l,"class","input-block"),y(l,"type","text"),y(l,"placeholder","Your guess"),l.required=!0,y(r,"class","form-group"),y(o,"class","col sm-10"),y(u,"class","button is-info is-large"),u.disabled=p=0===t[13].length,y(c,"class","col sm-2"),y(n,"class","row svelte-x46n78")},m(e,s){g(e,n,s),f(n,o),f(o,r),f(r,l),E(l,t[13]),f(n,i),f(n,c),f(c,u),f(u,a),d||(m=[x(l,"input",t[22]),x(u,"click",t[15])],d=!0)},p(e,t){8192&t[0]&&l.value!==e[13]&&E(l,e[13]),8192&t[0]&&p!==(p=0===e[13].length)&&(u.disabled=p)},i:e,o:e,d(e){e&&h(n),d=!1,s(m)}}}function Fe(e){let t,n,o,r,s=e[7],l=[];for(let t=0;t<s.length;t+=1)l[t]=Qe(Ue(e,s,t));const i=e=>Q(l[e],1,1,()=>{l[e]=null});return{c(){t=v("h2"),t.textContent="Got guesses:",n=k(),o=v("div");for(let e=0;e<l.length;e+=1)l[e].c();y(t,"class","has-text-centered"),y(o,"class","centered-flex")},m(e,s){g(e,t,s),g(e,n,s),g(e,o,s);for(let e=0;e<l.length;e+=1)l[e].m(o,null);r=!0},p(e,t){if(128&t[0]){let n;for(s=e[7],n=0;n<s.length;n+=1){const r=Ue(e,s,n);l[n]?(l[n].p(r,t),F(l[n],1)):(l[n]=Qe(r),l[n].c(),F(l[n],1),l[n].m(o,null))}for(X(),n=s.length;n<l.length;n+=1)i(n);Y()}},i(e){if(!r){for(let e=0;e<s.length;e+=1)F(l[e]);r=!0}},o(e){l=l.filter(Boolean);for(let e=0;e<l.length;e+=1)Q(l[e]);r=!1},d(e){e&&h(t),e&&h(n),e&&h(o),_(l,e)}}}function Qe(e){let t,n;return t=new me({props:{username:e[13].guesser_username}}),{c(){Z(t.$$.fragment)},m(e,o){ee(t,e,o),n=!0},p(e,n){const o={};128&n[0]&&(o.username=e[13].guesser_username),t.$set(o)},i(e){n||(F(t.$$.fragment,e),n=!0)},o(e){Q(t.$$.fragment,e),n=!1},d(e){te(t,e)}}}function Ze(e){let t,n,o,r,s,l,i,c,u,a,p;function d(e,t){return e[1]===e[14].WRITE_GUESS?Me:e[1]===e[14].PICK_GUESS?Ge:Re}let m=d(e),_=m(e);n=new xe({props:{lines:e[0].lines,editable:!1}});const w=[We,De,Le,Te],b=[];function x(e,t){return e[1]===e[14].WRITE_GUESS?0:e[1]===e[14].PICK_GUESS?1:e[1]===e[14].SCORE?2:e[1]===e[14].LEADERBOARD?3:-1}return~(r=x(e))&&(s=b[r]=w[r](e)),{c(){_.c(),t=k(),Z(n.$$.fragment),o=k(),s&&s.c(),l=k(),i=v("progress"),c=k(),u=v("h1"),a=$(e[11]),y(i,"class","progress margin-bottom svelte-x46n78"),i.value=e[12],j(i,"success",e[12]<.5),j(i,"warning",e[12]>=.5&&e[12]<.8),j(i,"danger",e[12]>=.8),y(u,"class","has-text-centered svelte-x46n78")},m(e,s){_.m(e,s),g(e,t,s),ee(n,e,s),g(e,o,s),~r&&b[r].m(e,s),g(e,l,s),g(e,i,s),g(e,c,s),g(e,u,s),f(u,a),p=!0},p(e,o){m!==(m=d(e))&&(_.d(1),_=m(e),_&&(_.c(),_.m(t.parentNode,t)));const c={};1&o[0]&&(c.lines=e[0].lines),n.$set(c);let u=r;r=x(e),r===u?~r&&b[r].p(e,o):(s&&(X(),Q(b[u],1,1,()=>{b[u]=null}),Y()),~r?(s=b[r],s||(s=b[r]=w[r](e),s.c()),F(s,1),s.m(l.parentNode,l)):s=null),(!p||4096&o[0])&&(i.value=e[12]),4096&o[0]&&j(i,"success",e[12]<.5),4096&o[0]&&j(i,"warning",e[12]>=.5&&e[12]<.8),4096&o[0]&&j(i,"danger",e[12]>=.8),(!p||2048&o[0])&&S(a,e[11])},i(e){p||(F(n.$$.fragment,e),F(s),p=!0)},o(e){Q(n.$$.fragment,e),Q(s),p=!1},d(e){_.d(e),e&&h(t),te(n,e),e&&h(o),~r&&b[r].d(e),e&&h(l),e&&h(i),e&&h(c),e&&h(u)}}}function et(e,t,n){let o,r,s,l;c(e,ce,e=>n(9,o=e)),c(e,ue,e=>n(10,r=e)),c(e,ie,e=>n(25,s=e));let{pictures:i}=t;const u={WRITE_GUESS:"write_guess",PICK_GUESS:"pick_guess",SCORE:"scoring",LEADERBOARD:"leaderboard"};let a,p=i[0],d=u.WRITE_GUESS,m="",f=!1,g=!1,h=[],_=[],v=[],w=[];function $(){0!=i.length?(n(0,p=i.shift()),v.push({prompt:p.prompt,guesser_username:p.username}),n(8,w=[]),n(1,d=u.WRITE_GUESS),n(2,f=p.username===o),n(13,m=""),n(5,h=[]),C.set(0,{duration:1e3}).then(()=>C.set(1)).then(()=>{f||alert("Please send a guess!")}),p.prompt===r&&(n(13,m="-----"),k())):alert("The end!")}let k=function(){_e.sendObject({type:"guessed_prompt",prompt:m.toUpperCase(),guesser_username:o}),n(2,f=!0)};let b=function(){p.username===a&&a!==o&&ie.update(e=>{let t=e.get(o);return t?(t.score+=1,e.set(o,t),console.log([...e]),e):(console.error("MISSING USER"),alert("MISSING USER!!!!"),e)}),console.log("sendVote message",a),_e.sendObject({type:"voted_prompt",voted_username:a,voter_username:o}),n(4,g=!0)},x=function(e){n(5,h=[...h,e]),console.log("givePoint to username",e),_e.sendObject({type:"give_point",receiver_username:e})};function y(){n(7,v=[]),n(1,d=u.LEADERBOARD),n(6,_=[...s.values()]),_.sort((e,t)=>100*(t.score-e.score)+t.lol_score-e.lol_score),n(6,_),C.set(.7,{duration:1e3}).then(()=>C.set(1,{duration:18e3})).then($)}const C=Se(0,{duration:6e4});c(e,C,e=>n(12,l=e)),$();let S;return e.$$set=e=>{"pictures"in e&&n(19,i=e.pictures)},e.$$.update=()=>{4096&e.$$.dirty[0]&&n(11,S=Math.floor(60*(1-l)))},[p,d,f,a,g,h,_,v,w,o,r,S,l,m,u,k,b,x,C,i,e=>{v.push(e),v.sort((e,t)=>e.prompt.localeCompare(t.prompt)),n(7,v),v.length===s.size&&(n(1,d=u.PICK_GUESS),n(4,g=!1),o===p.username&&(n(3,a=p.username),b()),r===p.prompt&&(n(3,a=o),b()),C.set(0,{duration:1e3}).then(()=>C.set(1)).then(()=>{g||alert("Please send a vote!")}))},e=>{console.log(e),n(8,w=[...w,e]),console.log(w),w.length===s.size&&(n(1,d=u.SCORE),C.set(.7,{duration:1e3}).then(()=>C.set(1,{duration:18e3})).then(y))},function(){m=this.value,n(13,m)},function(){a=I(this),n(3,a),n(7,v)},e=>x(e.guesser_username)]}class tt extends re{constructor(e){super(),oe(this,e,et,Ze,i,{pictures:19,onGuess:20,onVote:21},[-1,-1])}get onGuess(){return this.$$.ctx[20]}get onVote(){return this.$$.ctx[21]}}function nt(e,t,n){const o=e.slice();return o[15]=t[n],o}function ot(e,t,n){const o=e.slice();return o[12]=t[n],o}function rt(t){let n;return{c(){n=v("h1"),n.textContent="UNKNOWN STATE AAAA",y(n,"class","has-text-centered")},m(e,t){g(e,n,t)},p:e,i:e,o:e,d(e){e&&h(n)}}}function st(e){let t,n,o={pictures:e[2]};return t=new tt({props:o}),e[7](t),{c(){Z(t.$$.fragment)},m(e,o){ee(t,e,o),n=!0},p(e,n){const o={};4&n&&(o.pictures=e[2]),t.$set(o)},i(e){n||(F(t.$$.fragment,e),n=!0)},o(e){Q(t.$$.fragment,e),n=!1},d(n){e[7](null),te(t,n)}}}function lt(e){let t,n,o,r,s=e[2],l=[];for(let t=0;t<s.length;t+=1)l[t]=at(nt(e,s,t));const i=e=>Q(l[e],1,1,()=>{l[e]=null});return{c(){t=v("h1"),t.textContent="Waiting for other players to finish drawing, got:",n=k(),o=v("div");for(let e=0;e<l.length;e+=1)l[e].c();y(t,"class","has-text-centered"),y(o,"class","centered-flex")},m(e,s){g(e,t,s),g(e,n,s),g(e,o,s);for(let e=0;e<l.length;e+=1)l[e].m(o,null);r=!0},p(e,t){if(4&t){let n;for(s=e[2],n=0;n<s.length;n+=1){const r=nt(e,s,n);l[n]?(l[n].p(r,t),F(l[n],1)):(l[n]=at(r),l[n].c(),F(l[n],1),l[n].m(o,null))}for(X(),n=s.length;n<l.length;n+=1)i(n);Y()}},i(e){if(!r){for(let e=0;e<s.length;e+=1)F(l[e]);r=!0}},o(e){l=l.filter(Boolean);for(let e=0;e<l.length;e+=1)Q(l[e]);r=!1},d(e){e&&h(t),e&&h(n),e&&h(o),_(l,e)}}}function it(e){let t,n,o,r;return o=new Pe({props:{prompt:e[0]}}),{c(){t=v("h1"),t.textContent="Let's draw!",n=k(),Z(o.$$.fragment),y(t,"class","has-text-centered")},m(e,s){g(e,t,s),g(e,n,s),ee(o,e,s),r=!0},p(e,t){const n={};1&t&&(n.prompt=e[0]),o.$set(n)},i(e){r||(F(o.$$.fragment,e),r=!0)},o(e){Q(o.$$.fragment,e),r=!1},d(e){e&&h(t),e&&h(n),te(o,e)}}}function ct(e){let t,n,o,r,s,l,i,c,u,a,p=e[3],d=[];for(let t=0;t<p.length;t+=1)d[t]=pt(ot(e,p,t));const m=e=>Q(d[e],1,1,()=>{d[e]=null});return{c(){t=v("h1"),t.textContent="Waiting for other players",n=k(),o=v("div");for(let e=0;e<d.length;e+=1)d[e].c();r=k(),s=v("button"),l=$("Everybody in!"),y(t,"class","has-text-centered"),y(o,"class","centered-flex"),y(s,"class","button centered-flex"),s.disabled=i=e[3].length<2},m(i,p){g(i,t,p),g(i,n,p),g(i,o,p);for(let e=0;e<d.length;e+=1)d[e].m(o,null);g(i,r,p),g(i,s,p),f(s,l),c=!0,u||(a=x(s,"click",e[6],{once:!0}),u=!0)},p(e,t){if(8&t){let n;for(p=e[3],n=0;n<p.length;n+=1){const r=ot(e,p,n);d[n]?(d[n].p(r,t),F(d[n],1)):(d[n]=pt(r),d[n].c(),F(d[n],1),d[n].m(o,null))}for(X(),n=p.length;n<d.length;n+=1)m(n);Y()}(!c||8&t&&i!==(i=e[3].length<2))&&(s.disabled=i)},i(e){if(!c){for(let e=0;e<p.length;e+=1)F(d[e]);c=!0}},o(e){d=d.filter(Boolean);for(let e=0;e<d.length;e+=1)Q(d[e]);c=!1},d(e){e&&h(t),e&&h(n),e&&h(o),_(d,e),e&&h(r),e&&h(s),u=!1,a()}}}function ut(t){let n,o;return n=new he({}),n.$on("login",t[5]),{c(){Z(n.$$.fragment)},m(e,t){ee(n,e,t),o=!0},p:e,i(e){o||(F(n.$$.fragment,e),o=!0)},o(e){Q(n.$$.fragment,e),o=!1},d(e){te(n,e)}}}function at(e){let t,n;return t=new me({props:{username:e[15].username}}),{c(){Z(t.$$.fragment)},m(e,o){ee(t,e,o),n=!0},p(e,n){const o={};4&n&&(o.username=e[15].username),t.$set(o)},i(e){n||(F(t.$$.fragment,e),n=!0)},o(e){Q(t.$$.fragment,e),n=!1},d(e){te(t,e)}}}function pt(e){let t,n;return t=new me({props:{username:e[12][0]}}),{c(){Z(t.$$.fragment)},m(e,o){ee(t,e,o),n=!0},p(e,n){const o={};8&n&&(o.username=e[12][0]),t.$set(o)},i(e){n||(F(t.$$.fragment,e),n=!0)},o(e){Q(t.$$.fragment,e),n=!1},d(e){te(t,e)}}}function dt(e){let t,n,o,r,s,l,i;const c=[ut,ct,it,lt,st,rt],u=[];function a(e,t){return"login"===e[4]?0:"wait_start"===e[4]?1:"draw"===e[4]?2:"wait_drawers"===e[4]?3:"guess"===e[4]?4:5}return n=a(e),o=u[n]=c[n](e),{c(){t=v("div"),o.c(),r=k(),s=v("iframe"),y(s,"title","music"),y(s,"id","music-iframe"),s.src!==(l="https://www.youtube.com/embed/D1RhfadVSXI")&&y(s,"src","https://www.youtube.com/embed/D1RhfadVSXI"),y(t,"class","container svelte-l24f7x")},m(e,o){g(e,t,o),u[n].m(t,null),f(t,r),f(t,s),i=!0},p(e,[s]){let l=n;n=a(e),n===l?u[n].p(e,s):(X(),Q(u[l],1,1,()=>{u[l]=null}),Y(),o=u[n],o||(o=u[n]=c[n](e),o.c()),F(o,1),o.m(t,r))},i(e){i||(F(o),i=!0)},o(e){Q(o),i=!1},d(e){e&&h(t),u[n].d()}}}function mt(e,t,n){let o,r,s,l;c(e,ie,e=>n(10,o=e)),c(e,ce,e=>n(11,r=e)),c(e,ae,e=>n(4,s=e));let i,u,a="",p=[];return _e.onMessage=e=>{switch(console.log(e.type),console.log(e),e.type){case"new_user":const t={username:e.username,img_src:e.img_src,proposed_prompt:e.proposed_prompt};ie.update(e=>(e.set(t.username,{lol_score:0,username:t.username,score:0,img_src:t.img_src,proposed_prompt:t.proposed_prompt}),console.log([...e]),e)),t.username===r&&(ae.set("wait_start"),console.log("Connected: ",e));break;case"old_users":const s=Object.entries(e.users).map(e=>({score:0,lol_score:0,username:e[0],img_src:e[1][0],proposed_prompt:e[1][1]}));ie.update(e=>{for(let t of s)e.set(t.username,{score:0,lol_score:0,img_src:t.img_src,username:t.username,proposed_prompt:t.proposed_prompt});return e});break;case"start_game":ae.set("draw"),n(0,a=e.assigned_prompt);break;case"picture":n(2,p=[...p,{username:e.username,lines:e.lines,prompt:e.prompt}]),p.sort(),console.log(p),p.length===o.size&&ae.set("guess");break;case"guessed_prompt":i.onGuess(e);break;case"voted_prompt":e.voted_username!==e.voter_username&&ie.update(t=>{let n=t.get(e.voted_username);return n?(n.score+=1,t.set(e.voted_username,n),console.log([...t]),t):(console.error("MISSING USER"),alert("MISSING USER!!!!"),t)}),i.onVote(e);break;case"give_point":ie.update(t=>{let n=t.get(e.receiver_username);return n?(n.lol_score+=1,t.set(e.receiver_username,n),console.log([...t]),t):(console.error("MISSING USER"),alert("MISSING USER!!!!"),t)});break;default:alert("Unknown type, see console"),console.error(e)}},e.$$.update=()=>{1024&e.$$.dirty&&n(3,u=[...o])},[a,i,p,u,s,function(e){ae.set("wait_start");let t=e.detail.username;l=e.detail.img_src;let n=e.detail.prompt.toUpperCase();ce.set(t),ue.set(n),ie.update(e=>(e.set(t,{lol_score:0,username:t,score:0,img_src:l,proposed_prompt:n}),console.log([...e]),e)),console.log("Logged in: ",e.detail);let o=document.getElementById("telegram-login-minnybot");(null==o?void 0:o.parentNode)&&o.parentNode.removeChild(o),_e.setUp(t,l,n)},function(){_e.sendObject({type:"start_game",assigned_prompt:""})},function(e){M[e?"unshift":"push"](()=>{i=e,n(1,i)})}]}return new class extends re{constructor(e){super(),oe(this,e,mt,dt,i,{})}}({target:document.body,props:{}})}();
//# sourceMappingURL=bundle.js.map
